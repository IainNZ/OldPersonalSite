<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
	<channel>
		<title>IainDunning.com</title>
		<description>Experiences, thoughts, and technical notes.</description>		
		<link>http://iaindunning.com</link>
		<atom:link href="http://iaindunning.com/feed.xml" rel="self" type="application/rss+xml" />
		
			<item>
				<title>Using JuMP to Solve a TSP with Lazy Constraints</title>
				<description>&lt;p&gt;&lt;a href=&quot;http://github.com/JuliaOpt/JuMP.jl&quot;&gt;JuMP&lt;/a&gt; is an algebraic modeling language for optimization problems implemented as a package for the &lt;a href=&quot;http://julialang.org&quot;&gt;Julia&lt;/a&gt; programming language. It works with many solvers, both open-source and commercial - see the &lt;a href=&quot;http://juliaopt.org&quot;&gt;JuliaOpt&lt;/a&gt; home page for more information. I&amp;#39;ve written &lt;a href=&quot;http://iaindunning.com/2013/urban-planning.html&quot;&gt;a&lt;/a&gt; &lt;a href=&quot;http://iaindunning.com/2013/combination-locks.html&quot;&gt;few&lt;/a&gt; &lt;a href=&quot;http://iaindunning.com/2013/sudoku-as-a-service.html&quot;&gt;times&lt;/a&gt; about solving problems with JuMP.&lt;/p&gt;

&lt;p&gt;We just released &lt;strong&gt;version 0.2&lt;/strong&gt; of JuMP which, among other things, provides solver-independent callbacks for &lt;a href=&quot;http://en.wikipedia.org/wiki/Linear_programming#Integer_unknowns&quot;&gt;mixed-integer linear programming problems&lt;/a&gt; (MILPs). MILPs are usually solved by solving a succession of linear relaxations of the original problem in a process known as branch-and-bound. Basically: if the solution of a linear relaxation has a fractional value for a variable that should be integral, (e.g. x = 4.3), we branch on that variable to create two new linear relaxation problems - one where the variable is constrained to be less than or equal to the rounded down value (e.g. x = 4) and other where the variable is constrained to be greather than or equal to the rounded up value (e.g. x = 5). There is a lot more that goes on to make this efficient, but that&amp;#39;s the basic idea.&lt;/p&gt;

&lt;p&gt;Optimization software often allows users to provide &lt;strong&gt;callback functions&lt;/strong&gt; that run when certain events happen in the branch-and-bound process, allowing the user to modify the solve process. The one I will describe today allows us to add a new constraint to the problem that may &amp;quot;cut off&amp;quot; a solution to the problem whenever a new solution is found -  a &lt;strong&gt;&amp;quot;lazy constraint&amp;quot;&lt;/strong&gt;. You can read more about lazy constraints at &lt;a href=&quot;http://orinanobworld.blogspot.com/2012/08/user-cuts-versus-lazy-constraints.html&quot;&gt;Paul Rubin&amp;#39;s blog&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;A problem with solver callbacks is that each solver implements them differently. Some solvers may allow the user to provide one callback function and pass a parameter into the callback telling it what the solve state is and what the user can now do. Other solvers want a different callback for every possible situation. For this reason, and probably others, unifying all these interfaces across solvers in a simple way hasn&amp;#39;t really been done before in an solver-independent algebraic modeling language. JuMP makes the process as simple as can be (hopefully), and you can &lt;strong&gt;&lt;a href=&quot;https://jump.readthedocs.org/en/release-0.2/jump.html#solver-callbacks&quot;&gt;read the documentation to find out more&lt;/a&gt;&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;In this blog post I will demonstrate how you can use JuMP&amp;#39;s lazy constraint callback functionality to solve a travelling salesman problem (TSP) using &lt;strong&gt;subtour elimination constraints&lt;/strong&gt;. To follow along at home you&amp;#39;ll need one (but preferably at least two of): GNU GLPK, Gurobi, or CPLEX. To install Julia, see the &lt;a href=&quot;http://julialang.org/downloads/&quot;&gt;Download page&lt;/a&gt; and to install JuMP you can run the following commands at the Julia prompt:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;julia&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Update package listing&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Pkg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Install JuMP&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Pkg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;JuMP&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Install interface to your solver of choice.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Further setup might be required for these - see the README for each package!&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Gurobi&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# https://github.com/JuliaOpt/Gurobi.jl&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Pkg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Gurobi&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 
&lt;span class=&quot;c&quot;&gt;# GNU GLPK&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# https://github.com/JuliaOpt/GLPK.jl&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Pkg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;GLPK&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Pkg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;GLPKMathProgInterface&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# CPLEX (experimental!)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# https://github.com/joehuchette/CPLEXLink.jl&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Pkg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;CPLEXLink&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Formulating the TSP integer program&lt;/h3&gt;

From the &lt;a href=&quot;http://www.tsp.gatech.edu/problem/index.html&quot;&gt;Georgia Institue of Technology website&lt;/a&gt;:

&lt;blockquote&gt;Given a collection of cities and the cost of travel between each pair of them, the traveling salesman problem, or TSP for short, is to find the cheapest way of visiting all of the cities and returning to your starting point. In the standard version we study, the travel costs are symmetric in the sense that traveling from city X to city Y costs just as much as traveling from Y to X.&lt;/blockquote&gt;

One way to write the (partial) integer programming formulation of the undirected version of this problem is:

&lt;div&gt;
$$
\begin{align}
\min_{x\in\{0,1\}} &amp; \sum_{i=1,\dots,n,j=i,\dots,n} d_{i,j} x_{i,j} \\
\text{Subject to}  &amp; x_{i,j} = x_{j,i} \quad \forall i,j \\
                   &amp; x_{i,i} = 0 \quad \forall i \\
                   &amp; \sum_{j=1,\dots,n} x_{i,j} = 2 \quad \forall i
\end{align}
$$
&lt;/div&gt;

&lt;p&gt;The translation of this math is as follows:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;\( x_{i,j} \) variable is 1 if we go between city \( i \) and city \( j \)  on our tour.&lt;/li&gt;
&lt;li&gt;\( d_{i,j} \) is the distance or cost between the two cities.&lt;/li&gt;
&lt;li&gt;The first constraint makes our problem undirected (going from i to j is the same as going from j to i)&lt;/li&gt;
&lt;li&gt;The second constraint removes the variables that correspond to leaving and entering the same city.&lt;/li&gt;
&lt;li&gt;The final constraints says we must enter and leave a city once and once only.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This is unfortunately not sufficient to model the TSP. Consider the following solution, which you can check satisfies all the constraints and is significantly shorter than the true solution.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;julia&quot;&gt;&lt;span class=&quot;c&quot;&gt;# The + are our cities&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#       +           +&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#   +                   +&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#       +           +&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# The solution to the above problem is&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#    /--+           +--\&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#   +   |           |   +&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#    \--+           +--/&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# But it should be&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#    /--+-----------+--\&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#   +                   +&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#    \--+-----------+--/&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;We can remove these &amp;quot;incorrect&amp;quot; solutions using so-called &amp;quot;subtour-elimination constraints&amp;quot; (see again the &lt;a href=&quot;http://www.tsp.gatech.edu/methods/opt/subtour.htm&quot;&gt;Georgia Tech&lt;/a&gt; website). These constraints essentially say that for any given set of cities, if you treat that set as a black box there must be at least one trip into that set and one trip out. Unfortunately there are an &lt;strong&gt;exponential number of subsets of cities&lt;/strong&gt;, and so an exponential number of constraints. We could generate them all but you will find that, in practice, very few are actually needed. The secret is to add them &amp;quot;lazily&amp;quot; - only when they are needed. You only need one constraint to &amp;quot;correct&amp;quot; the solution to our example problem above.&lt;/p&gt;

&lt;h3&gt;Solving the relaxed problem with JuMP&lt;/h3&gt;

&lt;p&gt;Let&amp;#39;s first solve the problem without callbacks and subtour elimination constraints. Here is the code I came up with. I solved it with Gurobi, and the full final code is in the &lt;a href=&quot;https://github.com/JuliaOpt/JuMP.jl/blob/master/examples/tsp.jl&quot;&gt;JuMP examples&lt;/a&gt; folder. I don&amp;#39;t define &lt;code&gt;extractTour&lt;/code&gt; here - see the example file, it simply turns the &lt;code&gt;x&lt;/code&gt; matrix of 0-1s into a human-readable description of the tour.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;julia&quot;&gt;&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JuMP&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Gurobi&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# solveTSP&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Given a matrix of city locations, solve the TSP&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Inputs:&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#   n       Number of cities&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#   cities  n-by-2 matrix of (x,y) city locations&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Output:&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#   path    Vector with order to cities are visited in&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt; solveTSP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cities&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;# Calculate pairwise distance matrix&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dist&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cities&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cities&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;dist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;dist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;# Create a model that we will use Gurobi to solve&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# We need to tell Gurobi we are using lazy constraints&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;solver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GurobiSolver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LazyConstraints&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;# x[i,j] is 1 iff we travel between i and j, 0 otherwise&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# Although we define all n^2 variables, we will only use&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# the upper triangle&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;defVar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Bin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;# Minimize length of tour&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setObjective&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;# Make x_ij and x_ji be the same thing (undirectional)&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# Don&amp;#39;t allow self-arcs&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addConstraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addConstraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;# We must enter and leave every city once and only once&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addConstraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;# Solve the problem&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;# Return best tour&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extractTour&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;  &lt;span class=&quot;c&quot;&gt;# end solveTSP&lt;/span&gt;


&lt;span class=&quot;c&quot;&gt;# Create a simple instance that looks like&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#       +           +&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#   +                   +&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#       +           +&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cities&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;300&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;mi&quot;&gt;500&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;mi&quot;&gt;500&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;300&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;mi&quot;&gt;550&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;solveTSP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cities&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Solution: &amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tour&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;As you can see, there is pretty much a line-to-line correspondence between the JuMP constraint and objective definitions and the mathematical statement of the problem.&lt;/p&gt;

&lt;h3&gt;Implementing the lazy constraint callback&lt;/h3&gt;

&lt;p&gt;To add a subtour elimination constraint, we first need to identify a subtour. In the &lt;a href=&quot;https://github.com/JuliaOpt/JuMP.jl/blob/master/examples/tsp.jl&quot;&gt;example code&lt;/a&gt; I create a simple function &lt;code&gt;findSubtour(n, sol)&lt;/code&gt; that takes the matrix of 0-1 solutions and returns a length &lt;code&gt;n&lt;/code&gt; vector of Booleans encoding the set of cities in one possible subtour. We can now use that to build a new constraint and add it to the problem:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;julia&quot;&gt;&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt; subtour&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# Find any set of cities in a subtour&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;subtour&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;subtour_length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;findSubtour&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;subtour_length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# This &amp;quot;subtour&amp;quot; is actually all cities, so we are done&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    
    &lt;span class=&quot;c&quot;&gt;# Subtour found - add lazy constraint&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# We will build it up piece-by-piece (variable-by-variable)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;arcs_from_subtour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AffExpr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subtour&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;c&quot;&gt;# If this city isn&amp;#39;t in subtour, skip it&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# Want to include all arcs from this city, which is in&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# the subtour, to all cities not in the subtour&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;
                &lt;span class=&quot;c&quot;&gt;# Self-arc&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;elseif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;subtour&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
                &lt;span class=&quot;c&quot;&gt;# Both ends in same subtour&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
                &lt;span class=&quot;c&quot;&gt;# j isn&amp;#39;t in subtour&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;arcs_from_subtour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;# Add the new subtour elimination constraint we built&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;addLazyConstraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arcs_from_subtour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Again, nothing too fancy. There are a few key things to understand here:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;As you can see in the full listing in the example code, this function is defined inside the same scope as the variables - this means you have access to &lt;code&gt;x[i,j]&lt;/code&gt;, making creating the new constraint easy.&lt;/li&gt;
&lt;li&gt;The logic for determining the subtour is elsewhere, and all we define here is the callback &amp;quot;stub&amp;quot;. This is good code design as it allows us to test the subtour code in isolation, as well as not &amp;quot;cluttering&amp;quot; the model definition.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;addLazyConstraint&lt;/code&gt; is a function defined by JuMP, and &lt;code&gt;AffExpr&lt;/code&gt; is a type defined by JuMP - it stands for affine expression.&lt;/li&gt;
&lt;li&gt;Our &lt;code&gt;subtour&lt;/code&gt; callback takes one argument, &lt;code&gt;cb&lt;/code&gt;. This is a handle used by JuMP to keep track of where things are in the solve process. &lt;code&gt;addLazyConstraint&lt;/code&gt; acts on &lt;code&gt;cb&lt;/code&gt;, unlike &lt;code&gt;addConstraint&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;All that is left is for us to tell JuMP to use our &lt;code&gt;subtour&lt;/code&gt; callback, as in the following snippet:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;julia&quot;&gt;    &lt;span class=&quot;c&quot;&gt;# ......&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# Add the new subtour elimination constraint we built&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;addLazyConstraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arcs_from_subtour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;  &lt;span class=&quot;c&quot;&gt;# End function subtour&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;# Solve the problem with our cut generator&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;setlazycallback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;subtour&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;# Return best tour&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extractTour&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;  &lt;span class=&quot;c&quot;&gt;# end solveTSP&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3&gt;Go try it!&lt;/h3&gt;

&lt;p&gt;This feature is new and (internally) a bit complicated to smooth over the differences in solvers. It &lt;em&gt;should&lt;/em&gt; work, but we are always happy to have more testers! To experience the magic of solver-independent callbacks you should only need to change two things - the &lt;code&gt;using&lt;/code&gt; line and the &lt;code&gt;Model&lt;/code&gt; line, e.g.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;julia&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Gurobi&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Gurobi&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;solver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GurobiSolver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LazyConstraints&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# GLPK&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GLPKMathProgInterface&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;solver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GLPKSolverMIP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# CPLEX&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CPLEXLink&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;solver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CplexSolver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Let us know how it goes. If you have issues open a report at the &lt;a href=&quot;https://github.com/JuliaOpt/JuMP.jl/issues?state=open&quot;&gt;JuMP issues page&lt;/a&gt;, &lt;a href=&quot;https://twitter.com/iaindunning&quot;&gt;Tweet at me&lt;/a&gt;, or email me (idunning AT mit DOT edu).&lt;/p&gt;

&lt;h3&gt;Coming soon&lt;/h3&gt;

&lt;p&gt;We hope to add support in JuMP for other common callbacks such as heuristics, cuts, and branching rules in the near future. Also on our mind is adding support for &lt;a href=&quot;http://scip.zib.de/&quot;&gt;SCIP&lt;/a&gt; (which has a wide variety of callbacks) and &lt;a href=&quot;http://www.sulumoptimization.com/&quot;&gt;Sulum&lt;/a&gt; (callbacks are coming soon).&lt;/p&gt;
</description>
				<pubDate>Sun, 15 Dec 2013 07:00:00 -0500</pubDate>
				<link>http://iaindunning.com/2013/mip-callback.html</link>
				<guid isPermaLink="true">http://iaindunning.com/2013/mip-callback.html</guid>
			</item>
		
			<item>
				<title>Representation, Filibusters and the US Senate</title>
				<description>&lt;p&gt;The &lt;a href=&quot;http://en.wikipedia.org/wiki/United_States_Senate&quot;&gt;Senate&lt;/a&gt; is one half of the legislative branch of the government of USA. It has 100 members, 2 from each state. Each of the 2 senators are elected separately on a simple majority basis (although some states have runoff elections if no candidate wins a majority). The consequence of these two decisions is that any two senators can represent widely different numbers of people.&lt;/p&gt;

&lt;p&gt;Consider first Wyoming, which on July 1st, 2012 was estimated to have a population
of 576,412 people, making it the smallest state. Assuming for the sake of simplicity that all these people can vote, to become a senator for Wyoming you would thus need to obtain at least 288,207 votes. On the other hand California, on the same date, was estimated to have a population of 38,041,430 people, so to become a senator for California would require 19,020,716 people to vote for you (under our assumption). The point is that a senator from California represents at least 66 times as many people as a senator from Wyoming. If everyone in California voted for the same senator, that senator could directly represent up to 132 times as many people as a senator from Wyoming that only just obtained a majority of the votes.&lt;/p&gt;

&lt;p&gt;A majority of 51 votes is required to pass a measure in the Senate . In the event
of a tie, the Vice President of the USA can step in to break the tie (&lt;a href=&quot;http://en.wikipedia.org/wiki/United_States_Vice_Presidents%27_tie-breaking_votes&quot;&gt;John Adams
did this 29 times!&lt;/a&gt;). However, an interesting &amp;quot;feature&amp;quot; of the Senate is the ability
to &lt;a href=&quot;http://en.wikipedia.org/wiki/Filibuster_in_the_United_States_Senate&quot;&gt;filibuster&lt;/a&gt;,
which means to essentially delay even having a vote by means of various tactics,
typically by simply speaking indefinitely on the matter. There is a way around this
tactic though: &amp;quot;three-fifths of the Senators duly chosen and sworn&amp;quot; (typically
60 votes) can agree to end the filibuster and move to vote. The filibuster
has been in the &lt;a href=&quot;http://www.nytimes.com/2013/11/22/us/politics/reid-sets-in-motion-steps-to-limit-use-of-filibuster.html?ref=politics&quot;&gt;news&lt;/a&gt; because the Senate recently
decided to limit the ability to use it - now a simple majority is sufficient to stop a filibuster for some measures (such as appointing judges to certain courts).&lt;/p&gt;

&lt;p&gt;The question I want to ask is - how representative or unrepresentative is the Senate
with and without the filibuster?&lt;/p&gt;

&lt;h2&gt;With the filibuster&lt;/h2&gt;

&lt;p&gt;Although a minority of Senators cannot pass measures, they can still block them.
Suppose there are two parties, the Apple party and the Orange party, and suppose
there are 41 senators from the Orange party. If all 41 Orange senators agree to,
they can filibuster endlessly as the Apple senators can never get the required 60
votes to end a filibuster. How many votes does the Orange party need to get 41
senators?&lt;/p&gt;

&lt;p&gt;Lets start with Wyoming, the smallest state. As stated before, the population of
Wyoming is 576,412, so the Orange party would need only to convince 288,207 people
to vote for their candidates to gain two senators (again using our simplifying
assumption that all people can vote). Let us repeat this process for the
20 smallest states, and also pick up another senator from the 21st smallest state, Iowa.&lt;/p&gt;

&lt;table style=&quot;text-align: center; margin-bottom: 20px&quot; width=&quot;100%&quot;&gt;
&lt;thead&gt;
  &lt;tr&gt;
    &lt;th&gt;State&lt;/th&gt;
    &lt;th&gt;Population&lt;/th&gt;
    &lt;th&gt;Majority&lt;/th&gt;
    &lt;th&gt;Running Total&lt;/th&gt;
    &lt;th&gt;Percent Total Population&lt;/th&gt;
    &lt;th&gt;Senators So Far&lt;/th&gt;
  &lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;&lt;td&gt;Wyoming&lt;/td&gt;&lt;td&gt;576412&lt;/td&gt;&lt;td&gt;288207&lt;/td&gt;&lt;td&gt;288207&lt;/td&gt;&lt;td&gt;0.1&lt;/td&gt;&lt;td&gt;2&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;Vermont&lt;/td&gt;&lt;td&gt;626011&lt;/td&gt;&lt;td&gt;313006&lt;/td&gt;&lt;td&gt;601213&lt;/td&gt;&lt;td&gt;0.2&lt;/td&gt;&lt;td&gt;4&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;North Dakota&lt;/td&gt;&lt;td&gt;699628&lt;/td&gt;&lt;td&gt;349815&lt;/td&gt;&lt;td&gt;951028&lt;/td&gt;&lt;td&gt;0.3&lt;/td&gt;&lt;td&gt;6&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;Alaska&lt;/td&gt;&lt;td&gt;731449&lt;/td&gt;&lt;td&gt;365725&lt;/td&gt;&lt;td&gt;1316753&lt;/td&gt;&lt;td&gt;0.4&lt;/td&gt;&lt;td&gt;8&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;South Dakota&lt;/td&gt;&lt;td&gt;833354&lt;/td&gt;&lt;td&gt;416678&lt;/td&gt;&lt;td&gt;1733431&lt;/td&gt;&lt;td&gt;0.6&lt;/td&gt;&lt;td&gt;10&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;Delaware&lt;/td&gt;&lt;td&gt;917092&lt;/td&gt;&lt;td&gt;458547&lt;/td&gt;&lt;td&gt;2191978&lt;/td&gt;&lt;td&gt;0.7&lt;/td&gt;&lt;td&gt;12&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;Montana&lt;/td&gt;&lt;td&gt;1005141&lt;/td&gt;&lt;td&gt;502571&lt;/td&gt;&lt;td&gt;2694549&lt;/td&gt;&lt;td&gt;0.9&lt;/td&gt;&lt;td&gt;14&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;Rhode Island&lt;/td&gt;&lt;td&gt;1050292&lt;/td&gt;&lt;td&gt;525147&lt;/td&gt;&lt;td&gt;3219696&lt;/td&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;16&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;New Hampshire&lt;/td&gt;&lt;td&gt;1320718&lt;/td&gt;&lt;td&gt;660360&lt;/td&gt;&lt;td&gt;3880056&lt;/td&gt;&lt;td&gt;1.2&lt;/td&gt;&lt;td&gt;18&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;Maine&lt;/td&gt;&lt;td&gt;1329192&lt;/td&gt;&lt;td&gt;664597&lt;/td&gt;&lt;td&gt;4544653&lt;/td&gt;&lt;td&gt;1.5&lt;/td&gt;&lt;td&gt;20&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;Hawaii&lt;/td&gt;&lt;td&gt;1392313&lt;/td&gt;&lt;td&gt;696157&lt;/td&gt;&lt;td&gt;5240810&lt;/td&gt;&lt;td&gt;1.7&lt;/td&gt;&lt;td&gt;22&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;Idaho&lt;/td&gt;&lt;td&gt;1595728&lt;/td&gt;&lt;td&gt;797865&lt;/td&gt;&lt;td&gt;6038675&lt;/td&gt;&lt;td&gt;1.9&lt;/td&gt;&lt;td&gt;24&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;West Virginia&lt;/td&gt;&lt;td&gt;1855413&lt;/td&gt;&lt;td&gt;927707&lt;/td&gt;&lt;td&gt;6966382&lt;/td&gt;&lt;td&gt;2.2&lt;/td&gt;&lt;td&gt;26&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;Nebraska&lt;/td&gt;&lt;td&gt;1855525&lt;/td&gt;&lt;td&gt;927763&lt;/td&gt;&lt;td&gt;7894145&lt;/td&gt;&lt;td&gt;2.5&lt;/td&gt;&lt;td&gt;28&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;New Mexico&lt;/td&gt;&lt;td&gt;2085538&lt;/td&gt;&lt;td&gt;1042770&lt;/td&gt;&lt;td&gt;8936915&lt;/td&gt;&lt;td&gt;2.9&lt;/td&gt;&lt;td&gt;30&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;Nevada&lt;/td&gt;&lt;td&gt;2758931&lt;/td&gt;&lt;td&gt;1379466&lt;/td&gt;&lt;td&gt;10316381&lt;/td&gt;&lt;td&gt;3.3&lt;/td&gt;&lt;td&gt;32&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;Utah&lt;/td&gt;&lt;td&gt;2855287&lt;/td&gt;&lt;td&gt;1427644&lt;/td&gt;&lt;td&gt;11744025&lt;/td&gt;&lt;td&gt;3.7&lt;/td&gt;&lt;td&gt;34&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;Kansas&lt;/td&gt;&lt;td&gt;2885905&lt;/td&gt;&lt;td&gt;1442953&lt;/td&gt;&lt;td&gt;13186978&lt;/td&gt;&lt;td&gt;4.2&lt;/td&gt;&lt;td&gt;36&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;Arkansas&lt;/td&gt;&lt;td&gt;2949131&lt;/td&gt;&lt;td&gt;1474566&lt;/td&gt;&lt;td&gt;14661544&lt;/td&gt;&lt;td&gt;4.7&lt;/td&gt;&lt;td&gt;38&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;Mississippi&lt;/td&gt;&lt;td&gt;2984926&lt;/td&gt;&lt;td&gt;1492464&lt;/td&gt;&lt;td&gt;16154008&lt;/td&gt;&lt;td&gt;5.2&lt;/td&gt;&lt;td&gt;40&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;Iowa&lt;/td&gt;
  &lt;td&gt;3074186&lt;/td&gt;
  &lt;td&gt;1537094&lt;/td&gt;
  &lt;td&gt;&lt;strong&gt;17691102&lt;/strong&gt;&lt;/td&gt;
  &lt;td&gt;&lt;strong&gt;5.6&lt;/strong&gt;&lt;/td&gt;
  &lt;td&gt;41&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;strong&gt;We can see that the support of 5.6% of the population (or of voters, if the proportion of people
who can vote in each state is similar) is sufficient to block a measure in the Senate.&lt;/strong&gt;&lt;/p&gt;

&lt;h2&gt;Without the filibuster&lt;/h2&gt;

&lt;p&gt;Without the filibuster, and assuming the President is a member of the Apple Party, the Orange Party needs to have majority of 51 votes to block measures. We&amp;#39;re going to need another ten Senators then from the next 10 smallest states:&lt;/p&gt;

&lt;table style=&quot;text-align: center; margin-bottom: 20px&quot; width=&quot;100%&quot;&gt;
&lt;thead&gt;
  &lt;tr&gt;
    &lt;th&gt;State&lt;/th&gt;
    &lt;th&gt;Population&lt;/th&gt;
    &lt;th&gt;Majority&lt;/th&gt;
    &lt;th&gt;Running Total&lt;/th&gt;
    &lt;th&gt;Percent Total Population&lt;/th&gt;
    &lt;th&gt;Senators So Far&lt;/th&gt;
  &lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;&lt;td&gt;Iowa&lt;/td&gt;&lt;td&gt;3074186&lt;/td&gt;&lt;td&gt;1537094&lt;/td&gt;&lt;td&gt;17691102&lt;/td&gt;&lt;td&gt;5.6&lt;/td&gt;&lt;td&gt;42&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt; Connecticut&lt;/td&gt;&lt;td&gt;3590347&lt;/td&gt;&lt;td&gt;1795174&lt;/td&gt;&lt;td&gt;19486276&lt;/td&gt;&lt;td&gt;6.2&lt;/td&gt;&lt;td&gt;44&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt; Oklahoma&lt;/td&gt;&lt;td&gt;3814820&lt;/td&gt;&lt;td&gt;1907411&lt;/td&gt;&lt;td&gt;21393687&lt;/td&gt;&lt;td&gt;6.8&lt;/td&gt;&lt;td&gt;46&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt; Oregon&lt;/td&gt;&lt;td&gt;3899353&lt;/td&gt;&lt;td&gt;1949677&lt;/td&gt;&lt;td&gt;23343364&lt;/td&gt;&lt;td&gt;7.5&lt;/td&gt;&lt;td&gt;48&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt; Kentucky&lt;/td&gt;&lt;td&gt;4380415&lt;/td&gt;&lt;td&gt;2190208&lt;/td&gt;&lt;td&gt;25533572&lt;/td&gt;&lt;td&gt;8.2&lt;/td&gt;&lt;td&gt;50&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt; Louisiana&lt;/td&gt;&lt;td&gt;4601893&lt;/td&gt;&lt;td&gt;2300947&lt;/td&gt;&lt;td&gt;&lt;strong&gt;27834519&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;&lt;strong&gt;8.9&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;51&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;strong&gt;We can see that the support of 8.9% of the population (or of voters, if the proportion of people
who can vote in each state is similar) is sufficient to block a measure in the Senate
even without the filibuster.&lt;/strong&gt;&lt;/p&gt;

&lt;h2&gt;Real life&lt;/h2&gt;

&lt;p&gt;While the above numbers look (and are) worrying, the real situation is surely not so bad. In the US Senate right now there are 53 Democratic Party senators, 45 Republican Party senators, and two independents - thus the Republican Party can filibuster the Democratic Party, and the Democratic Party can block any measure of the Republican Party. How representative are these 100 senators of the total population? One way to answer this question is the following:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;If both senators are from same party then the population of that state is allocated to that party.&lt;/li&gt;
&lt;li&gt;If the senators are from different parties then each party is allocated half the population of that state.&lt;/li&gt;
&lt;li&gt;Angus King, Senator for Maine, and Bernie Sanders, Senator for Vermont, generally work with the Democratic Party so we will treat them as members.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;If you do the math using &lt;a href=&quot;http://en.wikipedia.org/wiki/List_of_current_United_States_Senators&quot;&gt;this list&lt;/a&gt; you will find that the Democratic Party + independents represent 58.2% of the population, and the Republican Party represents 41.8%. That seems like a reasonable enough outcome, but there is a catch.&lt;/p&gt;

&lt;p&gt;Suppose, for arguments sake, that each Republican senator won their seat by getting 50%+1 of the votes. What percentage of the population would you need to get those same 45 senate spots they currently hold? It turns out to be only 20.9%. Likewise, the Democratic Party (+ independents) only need to convince 29.1% of the population to vote for them to hold their current 55 spots.&lt;/p&gt;

&lt;p&gt;Another interesting question is: only 41 Republicans are required to filibuster - so if we remove the four Republican senators who represent the most people, how many people do the remaining 41 senators represent at best (assume whole state voted for them) and at worst (assuming they barely won)? Texas has 2 Republican senators, Florida has one, and Illinois has one. Using the same method of apportioning people we used before, those 41 Republican senators represent the wishes of &amp;quot;at best&amp;quot; 28% of the population, and &amp;quot;at worse&amp;quot; only 14%.&lt;/p&gt;

&lt;h2&gt;Conclusions&lt;/h2&gt;

&lt;p&gt;The Senate does not represent the voices of the people. The argument for its existence and creation is usually claimed to be a check against the &amp;quot;tyranny of the majority&amp;quot; (the House, being a more representative body, represents the &amp;quot;majority&amp;quot; in this case). However, one must question whether this notion makes sense in the modern day and, even if it does, whether the degree to which a minority can block measures (with or without the even more &amp;quot;unrepresentative&amp;quot; filibuster) is a price worth paying.&lt;/p&gt;
</description>
				<pubDate>Fri, 22 Nov 2013 07:00:00 -0500</pubDate>
				<link>http://iaindunning.com/2013/us-senate.html</link>
				<guid isPermaLink="true">http://iaindunning.com/2013/us-senate.html</guid>
			</item>
		
			<item>
				<title>INFORMS 2013 and JuliaOpt</title>
				<description>&lt;p&gt;The &lt;a href=&quot;http://meetings2.informs.org/minneapolis2013/index.php&quot;&gt;INFORMS 2013&lt;/a&gt; Annual Meeting took place this past week in Minneapolis, and I was lucky enough to have the chance to go. &lt;a href=&quot;http://www.mit.edu/%7Emlubin/&quot;&gt;Miles Lubin&lt;/a&gt; and I were there to present a talk based on our paper &amp;quot;Computing on Operations Research using Julia&amp;quot; (&lt;a href=&quot;http://www.optimization-online.org/DB_HTML/2013/05/3883.html&quot;&gt;paper&lt;/a&gt;, &lt;a href=&quot;http://www.mit.edu/%7Emlubin/informs2013.pdf&quot;&gt;slides&lt;/a&gt;). I&amp;#39;d never been to a conference like this before, so I wasn&amp;#39;t sure what to expect - it turned out to be a bit overwhelming! There were four time slots per day, with up to 72 sessions running during each time slot. As a result it was impossible to see anything but a small fraction of the talks. The highlights for me would have to be:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Meeting with the team at &lt;a href=&quot;http://forio.com/&quot;&gt;Forio&lt;/a&gt; to talk about the work they are doing with Julia, including their simulation products and their open-source Julia IDE &lt;a href=&quot;http://forio.com/products/julia-studio&quot;&gt;Julia Studio&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Seeing the &lt;a href=&quot;https://www.informs.org/Recognize-Excellence/INFORMS-Prizes-Awards/George-Nicholson-Student-Paper-Competition&quot;&gt;Nicholson Prize&lt;/a&gt; contenders&amp;#39; presentations on Sunday, including &lt;a href=&quot;www.mit.edu/%7Evgupta1&quot;&gt;Vishal Gupta&lt;/a&gt;&amp;#39;s fantastic talk on data-driven robust optimization.&lt;/li&gt;
&lt;li&gt;Hacking on &lt;a href=&quot;http://github.com/JuliaOpt/JuMP.jl&quot;&gt;JuMP&lt;/a&gt; with Miles in our hotel room.&lt;/li&gt;
&lt;li&gt;Presenting the talk! We had a great, attentive audience, it was a real pleasure being there.&lt;/li&gt;
&lt;li&gt;Meeting the teams from &lt;a href=&quot;http://www.mosek.com&quot;&gt;MOSEK&lt;/a&gt; and &lt;a href=&quot;http://www.gurobi.com&quot;&gt;Gurobi&lt;/a&gt;, who were really enthusiastic about the work we are doing in Julia and want to be involved.&lt;/li&gt;
&lt;li&gt;Finally meeting the &lt;a href=&quot;http://www.coin-or.org/&quot;&gt;COIN-OR&lt;/a&gt; team, especially &lt;a href=&quot;http://coral.ie.lehigh.edu/%7Eted/&quot;&gt;Ted Ralphs&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Celebrating Miles winning the &lt;a href=&quot;http://www.coin-or.org/coinCup/coinCup.html&quot;&gt;2013 COIN-OR Cup&lt;/a&gt;!&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;JuliaOpt&lt;/h2&gt;

&lt;p&gt;Miles and I put a lot of thought into whats next for the burgeoning collection of optimization software and interfaces in Julia, and felt it would be appropriate to emulate the example set by &lt;a href=&quot;https://github.com/JuliaStats&quot;&gt;JuliaStats&lt;/a&gt; and pull all the code together in one place. We want to go further and make sure everything works together, is well documented, and well tested. One of the end goal is to make Julia &lt;em&gt;the&lt;/em&gt; choice for people working with optimization problems.&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;http://juliaopt.org/images/logo300.png&quot; alt=&quot;JuliaOpt logo - top: LP, left: NLP, right: IP&quot;&gt;&lt;p class=&quot;caption&quot;&gt;JuliaOpt logo - top: LP, left: NLP, right: IP&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;We&amp;#39;ve set up a &lt;a href=&quot;https://github.com/JuliaOpt&quot;&gt;JuliaOpt GitHub organization&lt;/a&gt; and a &lt;a href=&quot;http://juliaopt.org&quot;&gt;JuliaOpt website&lt;/a&gt; - check them out the projects, use it, report bugs, and contribute back - we&amp;#39;d love to have you join us.&lt;/p&gt;
</description>
				<pubDate>Sat, 12 Oct 2013 08:00:00 -0400</pubDate>
				<link>http://iaindunning.com/2013/informs-juliaopt.html</link>
				<guid isPermaLink="true">http://iaindunning.com/2013/informs-juliaopt.html</guid>
			</item>
		
			<item>
				<title>Solving an Urban Planning Puzzle with JuMP + Julia</title>
				<description>&lt;p&gt;&lt;a href=&quot;http://puzzlor.com/&quot;&gt;The PuzzlOR&lt;/a&gt; is a website connected to &lt;a href=&quot;https://www.informs.org&quot;&gt;INFORMS&lt;/a&gt; that publishes &lt;a href=&quot;https://www.informs.org/About-INFORMS/What-is-Operations-Research&quot;&gt;operations research&lt;/a&gt;-related problems bimonthly. In a series of posts I&amp;#39;m going to solve some of the problems to demonstrate &lt;a href=&quot;https://github.com/JuliaOpt/JuMP.jl&quot;&gt;JuMP&lt;/a&gt;, an algebraic modeling language for/in &lt;a href=&quot;http://julialang.org&quot;&gt;Julia&lt;/a&gt;.&lt;/p&gt;

&lt;h2&gt;Urban Planning (August 2013)&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;http://puzzlor.com/2013-08_UrbanPlanning.html&quot;&gt;(Link to full problem statement)&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In this problem we have a 5x5 grid with two possibilities for each lot: residential or commercial. Let&amp;#39;s define a binary variable  \( x_{ij} \) that is 1 if and only if lot \( (i,j) \) is residential. The challenge now is to express the objective. For each row and column there are the following possibilities:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Five residential \( \sum_{j=1}^5 x_{ij} = 5 \) is +5 points&lt;/li&gt;
&lt;li&gt;Four residential \( \sum_{j=1}^5 x_{ij} = 4 \) is +4 points&lt;/li&gt;
&lt;li&gt;Three residential \( \sum_{j=1}^5 x_{ij} = 3 \) is +3 points&lt;/li&gt;
&lt;li&gt;Two residential \( \sum_{j=1}^5 x_{ij} = 2 \) is -3 points&lt;/li&gt;
&lt;li&gt;One residential \( \sum_{j=1}^5 x_{ij} = 1 \) is -4 points&lt;/li&gt;
&lt;li&gt;Zero residential \( \sum_{j=1}^5 x_{ij} = 0 \) is -5 points&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We will need additional variables that don&amp;#39;t directly correspond to a decision in the original problem, commonly referred to as auxiliary variables, to model this problem. Before we talk about that let&amp;#39;s first review some integer programming modelling &amp;quot;tricks&amp;quot;. &lt;/p&gt;

&lt;h3&gt;Modeling Logical Constraints with Binary Variables&lt;/h3&gt;

&lt;p&gt;In linear integer programming, all constraints must be linear in the decision variables. Solving non-linear integer programming problems is possible, but is significantly more difficult. The challenge of integer programming modeling then is to &amp;quot;linearize&amp;quot; all the logic of the problem. Consider the following constraints:&lt;/p&gt;

&lt;div&gt;
$$
y \geq 0.5 \\
y \in {0,1}
$$
&lt;/div&gt;

&lt;p&gt;Because \( y \) is a binary variable, the effect of these two constraints is to force \( y = 1 \). Consider the following extension, where \( z_1, z_2, z_3 \) are all binary variables:&lt;/p&gt;

&lt;div&gt;
$$
y \geq \frac{1}{3} \left( z_1 + z_2 + z_3 \right) \\
y \in {0,1}
$$
&lt;/div&gt;

&lt;p&gt;If any of the three \( z \) variables is 1, \( y \) is forced to equal one. This is equivalent to the logical statement &lt;em&gt;y = z1 or z2 or z3&lt;/em&gt;. Another way to write this for binary \( z \) is&lt;/p&gt;

&lt;div&gt;
$$
y \geq z_1 \\
y \geq z_2 \\
y \geq z_3 \\
y \in {0,1}
$$
&lt;/div&gt;

&lt;p&gt;Let&amp;#39;s apply this to the problem at hand.&lt;/p&gt;

&lt;h3&gt;Modeling the positive point cases&lt;/h3&gt;

&lt;p&gt;Define new variables&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;\( y_{R,i}^5 = 1 \) iff row \( i \) has 5 residential,&lt;/li&gt;
&lt;li&gt;\( y_{R,i}^4 = 1 \) iff row \( i \) has 4 or more residential,&lt;/li&gt;
&lt;li&gt;\( y_{R,i}^3 = 1 \) iff row \( i \) has 3 or more residential&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;and equivalent \( y_{C,i} \) for columns. The objective function of our problem, for the positive parts at least, can be written as&lt;/p&gt;

&lt;div&gt;
$$
(\max) \sum_{i=1}^5 (3 (y_{R,i}^3 + y_{C,i}^3) + 1 (y_{R,i}^4 + y_{C,i}^4) + 1 (y_{R,i}^5 + y_{C,i}^5))
$$
&lt;/div&gt;

&lt;p&gt;Note that \( x \) does not appear in the objective, and that the optimizer will want to set these \( y \) variables to one if at all possible to drive the objective function value higher. Knowing that, we simply need to restrict these variables from being 1 if the condition is not met. The following constraints achieve this goal:&lt;/p&gt;

&lt;div&gt;
$$
y_{R,i}^5 \leq \frac{1}{5} \sum_{j=1}^5 x_{ij} \\
y_{R,i}^4 \leq \frac{1}{4} \sum_{j=1}^5 x_{ij} \\
y_{R,i}^3 \leq \frac{1}{3} \sum_{j=1}^5 x_{ij}
$$
&lt;/div&gt;

&lt;p&gt;To understand why, consider the case where \( \sum_{j=1}^5 x_{ij} = 4 \). If we plug that in to the right-hand-side of each constraint we obtain:&lt;/p&gt;

&lt;div&gt;
$$
y_{R,i}^5 \leq \frac{4}{5} \rightarrow y_{R,i}^5 = 0 \\
y_{R,i}^4 \leq \frac{4}{4} \rightarrow y_{R,i}^4 \leq 1 \\
y_{R,i}^3 \leq \frac{4}{3} \rightarrow y_{R,i}^3 \leq 1
$$
&lt;/div&gt;

&lt;p&gt;When combined with the objective sense, the \( \leq \) is effectively an equality. Note also that if the sum of the \( x \) variables is zero on the right-hand-side, the problem is still feasible - that is, we don&amp;#39;t force the \( y \) variables to satisfy mutually exclusive constraints like&lt;/p&gt;

&lt;div&gt;
$$
y_{R,i}^3 \leq -0.5 \\
y_{R,i}^3 \in {0,1}
$$
&lt;/div&gt;

&lt;h3&gt;Modeling the negative point cases&lt;/h3&gt;

&lt;p&gt;We can use a similar approach for the negative point cases, but the constraints are perhaps less intuitive. As before, define variables&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;\( y_{R,i}^{-3} = 1 \) iff row \( i \) has 2 residential or less,&lt;/li&gt;
&lt;li&gt;\( y_{R,i}^{-4} = 1 \) iff row \( i \) has 1 residential or less,&lt;/li&gt;
&lt;li&gt;\( y_{R,i}^{-5} = 1 \) iff row \( i \) has 0 residential.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The objective function &amp;quot;contribution&amp;quot; from these variables can be written as&lt;/p&gt;

&lt;div&gt;
$$
(\max) \sum_{i=1}^5 (-3 (y_{R,i}^{-3} + y_{C,i}^{-3}) - 1 (y_{R,i}^{-4} + y_{C,i}^{-4}) - 1 (y_{R,i}^{-5} + y_{C,i}^{-5}))
$$
&lt;/div&gt;

&lt;p&gt;The optimizer tries to drive these variables towards zero. Before we were restricting variables away from one, but now we will restrict them &lt;em&gt;away&lt;/em&gt; from zero with the following constraints:&lt;/p&gt;

&lt;div&gt;
$$
y_{R,i}^{-3} \geq 1 - \frac{1}{3} \sum_{j=1}^5 x_{ij} \\
y_{R,i}^{-4} \geq 1 - \frac{1}{2} \sum_{j=1}^5 x_{ij} \\
y_{R,i}^{-5} \geq 1 - \frac{1}{1} \sum_{j=1}^5 x_{ij}
$$
&lt;/div&gt;

&lt;p&gt;As before, let&amp;#39;s consider an example. Suppose \( \sum_{j=1}^5 x_{ij} = 1 \):&lt;/p&gt;

&lt;div&gt;
$$
y_{R,i}^{-3} \geq 1 - \frac{1}{3} \rightarrow y_{R,i}^{-3} = 1 \\
y_{R,i}^{-4} \geq 1 - \frac{1}{2} \rightarrow y_{R,i}^{-4} = 1 \\
y_{R,i}^{-5} \geq 1 - \frac{1}{1} \rightarrow y_{R,i}^{-5} \geq 0 
$$
&lt;/div&gt;

&lt;p&gt;You can also check that all variables will set to 1 in the case where the sum is zero, and that if the sum is 3 or higher then all can be set to zero.&lt;/p&gt;

&lt;h3&gt;Putting it all together&lt;/h3&gt;

&lt;p&gt;Apart from a constraint to set the total number of residential lots, we have everything we need. Let&amp;#39;s build the model in JuMP and Julia.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;julia&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Assuming a solver has been previously installed, e.g. Cbc&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JuMP&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt; SolveUrban&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;c&quot;&gt;# x is indexed by row and column&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;defVar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;c&quot;&gt;# y is indexed by R or C, and the points&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# JuMP allows indexing on arbitrary sets&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;rowcol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;R&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;C&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;points&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;defVar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rowcol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;points&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;c&quot;&gt;# Objective - combine the positive and negative parts&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setObjective&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;R&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;C&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; 
  &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;R&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;C&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; 
  &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;R&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;C&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; 
  &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;R&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;C&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; 
  &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;R&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;C&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;R&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;C&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;

  &lt;span class=&quot;c&quot;&gt;# Constrain the number of residential lots&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addConstraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;c&quot;&gt;# Add the constraints that link the auxiliary y variables&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# to the x variables&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# Rows&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addConstraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;R&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt;   &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# sum = 5&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addConstraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;R&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt;   &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# sum = 4&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addConstraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;R&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt;   &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# sum = 3&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addConstraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;R&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# sum = 2&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addConstraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;R&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# sum = 1&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addConstraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;R&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# sum = 0&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# Columns&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addConstraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;C&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt;   &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# sum = 5&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addConstraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;C&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt;   &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# sum = 4&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addConstraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;C&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt;   &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# sum = 3&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addConstraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;C&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# sum = 2&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addConstraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;C&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# sum = 1&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addConstraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;C&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# sum = 0&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;c&quot;&gt;# Solve it with the default solver (CBC)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Infeasible&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Solver couldn&amp;#39;t find solution!&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;c&quot;&gt;# Print results&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Best objective: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;(round(getObjectiveValue(m)))&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;SolveUrban&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Try it yourself to see what the solution is. Do you believe the solution is correct, does it match your intuition?&lt;/p&gt;

&lt;h3&gt;Discussion&lt;/h3&gt;

&lt;p&gt;While you can probably solve this problem just by inspection and trying a few ideas, its interesting to consider how the an integer programming solver would handle this problem. The deep details of this are way beyond the scope of this blog post, but there are two main issues:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Symmetry: the rows and columns are all effectively interchangeable. For example, if row 1 has three residential lots and row 2 has four, we could swap these rows without changing the objective. This can be an issue for MIP solvers as there is a chance the solution will &amp;quot;bounce&amp;quot; between many equivalent possibilities before reaching optimality, although many techniques and heuristics are built into these solvers to counteract this and even harness it.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Fractionality: MIP solvers actually solve a succession of linear problems where the constraints \( x \in {0,1} \) are &lt;em&gt;relaxed&lt;/em&gt; to \( 0 \leq x \leq 1 \). The result of this is that when we initially solve the problem, many of \( y \) variables will be fractional. MIP solvers add &lt;em&gt;cuts&lt;/em&gt; (constraints that push the values towards the integer values) and &lt;em&gt;branch&lt;/em&gt; (solve two new problems with a fractional variables fixed to either 0 or 1) to eventually find an integer solution. They may also employ heuristics that attempt to construct an integer solution from the fractional solution.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The problem size here is so small that a solution is found almost instantly. However these are real issues for &amp;quot;real-world&amp;quot; problems and a lot of research is devoted to both improving solvers and studying the implications of different formulations.&lt;/p&gt;
</description>
				<pubDate>Mon, 30 Sep 2013 08:00:00 -0400</pubDate>
				<link>http://iaindunning.com/2013/urban-planning.html</link>
				<guid isPermaLink="true">http://iaindunning.com/2013/urban-planning.html</guid>
			</item>
		
			<item>
				<title>Solving a Combination Lock Puzzle with JuMP + Julia</title>
				<description>&lt;p&gt;&lt;a href=&quot;http://puzzlor.com/&quot;&gt;The PuzzlOR&lt;/a&gt; is a website connected to &lt;a href=&quot;https://www.informs.org&quot;&gt;INFORMS&lt;/a&gt; that publishes &lt;a href=&quot;https://www.informs.org/About-INFORMS/What-is-Operations-Research&quot;&gt;operations research&lt;/a&gt;-related problems bimonthly. In a series of posts I&amp;#39;m going to solve some of the problems to demonstrate &lt;a href=&quot;https://github.com/JuliaOpt/JuMP.jl&quot;&gt;JuMP&lt;/a&gt;, an algebraic modeling language for/in &lt;a href=&quot;http://julialang.org&quot;&gt;Julia&lt;/a&gt;.&lt;/p&gt;

&lt;h2&gt;Combination Locks (August 2012)&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;http://puzzlor.com/2012-08_CombinationLocks.html&quot;&gt;(Link to full problem statement)&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Our goal is to determine 6 numbers, where each of the 6 numbers has 6 possibilities and the sum of the numbers is 419. Lets first describe the possibilities (pulled from the image) as a matrix P:&lt;/p&gt;

&lt;div&gt;
$$
P =
 \begin{bmatrix}
  39 &amp; 06 &amp; 75 &amp; 88 &amp; 15 &amp; 57 \\
   9 &amp;  2 &amp; 58 &amp; 68 &amp; 48 &amp; 64 \\
  \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
  44 &amp; 63 &amp; 10 &amp; 83 &amp; 46 &amp; 03
 \end{bmatrix}
$$
&lt;/div&gt;

&lt;p&gt;We will model the problem as a integer program with variables \( x_{ij} \) that equal 1 if and only if for lock (row) &lt;em&gt;i&lt;/em&gt; we select the number (column) &lt;em&gt;j&lt;/em&gt;. Our model is thus the following feasibility problem:&lt;/p&gt;

&lt;div&gt;
$$
\begin{alignat*}{1}
\max \quad &amp; 0\\
\text{subject to} \quad &amp; \sum_{ij}D_{ij}x_{ij}=419\\
 &amp; \sum_{j=1}^6 x_{ij} = 1 \qquad \forall i \in \{1,\dots,6\}\\
 &amp; x_{ij}\in\left\{ 0,1\right\}
\end{alignat*}
$$
&lt;/div&gt;

&lt;p&gt;where the first constraint enforces the sum of the numbers equals 419, and the second constraint ensures we pick a number for each lock. We can solve this problem with the following code:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;julia&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Assuming a solver has been previously installed, e.g. Cbc&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JuMP&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt; SolveCombination&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c&quot;&gt;# Feasibility problem, sense unimportant&lt;/span&gt;
  
  &lt;span class=&quot;c&quot;&gt;# Variable x: 1 iff select number j for lock i&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;defVar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;c&quot;&gt;# Constraint 1: Sum of numbers is equal to 419&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addConstraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;419&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;c&quot;&gt;# Constraint 2: Must pick a number from each lock&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addConstraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;c&quot;&gt;# Solve with default solver (CBC)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Infeasible&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Couldn&amp;#39;t find the numbers!&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Found the numbers:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.99&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Lock &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;i is &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;(P[i,j])&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;P&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;39&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;06&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;75&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;88&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;57&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;58&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;68&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;48&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
     &lt;span class=&quot;mi&quot;&gt;29&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;55&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;67&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;91&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
     &lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;54&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;66&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
     &lt;span class=&quot;mi&quot;&gt;49&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;17&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;41&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
     &lt;span class=&quot;mi&quot;&gt;44&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;63&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;83&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;46&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SolveCombination&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;br&gt;
An extension question: what happens if relax constraint 2? How many locks would we need to make the sum 419 if we didn&amp;#39;t need to set all 6 locks?&lt;/p&gt;
</description>
				<pubDate>Sat, 21 Sep 2013 08:00:00 -0400</pubDate>
				<link>http://iaindunning.com/2013/combination-locks.html</link>
				<guid isPermaLink="true">http://iaindunning.com/2013/combination-locks.html</guid>
			</item>
		
			<item>
				<title>Sudoku-as-a-Service with Julia</title>
				<description>&lt;p&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Sudoku&quot;&gt;Sudoku&lt;/a&gt; is (was?) an extremely popular number puzzle. Players are presented with a 9 by 9 grid, with some of the cells filled in with a number between 1 and 9. The goal is to complete the grid while respecting these rules:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Each row of the grid must contain each of the numbers 1 to 9 exactly once.&lt;/li&gt;
&lt;li&gt;Each column of the grid must contain each of the numbers 1 to 9 exactly once.&lt;/li&gt;
&lt;li&gt;Divide the grid into 9 3-by-3 non-overlapping subgrids. Each of these 3-by-3 grids must contain each of the numbers 1 to 9 exactly once.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/sudokupuzzle.png&quot; alt=&quot;An unsolved sudoku puzzle (Wikimedia Commons)&quot;&gt;&lt;p class=&quot;caption&quot;&gt;An unsolved sudoku puzzle (Wikimedia Commons)&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;In this post I&amp;#39;m going to&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;walk through one way to solve sudoku puzzles, and &lt;/li&gt;
&lt;li&gt;show how you can offer that functionality as an online service&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;using the &lt;a href=&quot;http://julialang.org&quot;&gt;Julia&lt;/a&gt; programming language.&lt;/p&gt;

&lt;h2&gt;Solving Sudoku puzzles with integer programming&lt;/h2&gt;

&lt;p&gt;The rules of sudoku can be expressed as an &lt;a href=&quot;http://en.wikipedia.org/wiki/Integer_programming&quot;&gt;integer programming problem&lt;/a&gt; which can be solved by any of the many linear and integer programming solvers out there. Of course there are algorithms designed to solve sudoku problems directly that are probably more efficient than integer programming, but stay with me for a moment - I&amp;#39;ll justify it later on! We will start our model by defining a variable &lt;em&gt;x(i,j,k)&lt;/em&gt; that equals 1 if and only if cell &lt;em&gt;(i,j)&lt;/em&gt; is set to value &lt;em&gt;k&lt;/em&gt;, and is 0 otherwise.  This can be written mathematically (with constraints to enforce the fixed cells omitted) as:&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/sudokuform.png&quot; alt=&quot;MIP formulation of sudoku problem&quot;&gt;&lt;p class=&quot;caption&quot;&gt;MIP formulation of sudoku problem&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;Lets break down how these constraints translate back to the rules above. In the first set of constraints we enforce that for every row &lt;em&gt;i&lt;/em&gt;, across the columns &lt;em&gt;j&lt;/em&gt; the value &lt;em&gt;k&lt;/em&gt; must appear once and once only. For example, for value 5 and row 3, we say that &lt;em&gt;x(3,1,5) + x(3,2,5) + x(3,3,5) + ... + x(3,9,5) == 1&lt;/em&gt;. We can check: if a 5 appeared in row 3 column 2 and row 3 column 6, the sum on the left hand side would be 2. If 5 doesn&amp;#39;t appear in row 3 at all, the sum would be 0. Note that &lt;em&gt;x(3,1,5) = 0.5, x(3,2,5) = 0.5&lt;/em&gt; would be feasible with respect to this constraint, but that we are enforcing the constraint (not shown) that &lt;em&gt;x&lt;/em&gt; can only be 0 or 1.&lt;/p&gt;

&lt;p&gt;The second set of constraints is very similar to the first, and enforces the second &amp;#39;rule&amp;#39; above regarding columns. The third set of constraints is not so obvious. This set of constraints enforces that any given position &lt;em&gt;i,j&lt;/em&gt; can only contain one digit by summing across all values. This is kinda self-evident for a human so I didn&amp;#39;t even mention it above. Finally, the fourth set of constraints corresponds to the third rule. Its the most complex notationally, but is conceptually the same as the previous two. On the right side of the equations we iterate over the 9 3-by-3 subgrids, where (0,0) is the top left subgrid and (2,2) is the bottom subgrid. The sum is then over the 9 cells inside that subgrid. Lets pick an example subgrid, e.g. &lt;em&gt;(i,j)=(0,1)&lt;/em&gt; and &lt;em&gt;k=5&lt;/em&gt;, which corresponds to the left-center subgrid. We then sum over &lt;em&gt;a&lt;/em&gt; and &lt;em&gt;b&lt;/em&gt;: &lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;x(3*0+1,3*1+1,5) + x(3*0+2,3*1+1,5) + x(3*0+3,3*1+1,5) + x(3*0+1,3*1+2,5) + x(3*0+2,3*1+2,5) + ... == 1&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;x(1,4,5) + x(2,4,5) + x(3,4,5) + x(1,5,5) + x(2,5,5) + ... == 1&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;As I mentioned above, we have ommitted constraints that would fix particular &lt;em&gt;x(i,j,k)&lt;/em&gt; based on the provided cells, but there is no clean way to write that above. The question now is, how do we implement this model in an expressive and maintainable way in code?&lt;/p&gt;

&lt;h2&gt;JuMPing Julia!&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;http://julialang.org&quot;&gt;Julia&lt;/a&gt; is a fantastic up-and-coming dynamic language that emphasises high-performance scientific computing that is extensible and easy to read and write. It doesn&amp;#39;t reinvent the wheel: it utilizes the &lt;a href=&quot;http://llvm.org/&quot;&gt;LLVM compiler&lt;/a&gt; to generate fast code, open-source linear algebra packages to provide fast number crunching, and the &lt;a href=&quot;https://github.com/joyent/libuv&quot;&gt;libuv&lt;/a&gt; library to provide excellent cross-platform IO. libuv is the library that powers the popular &lt;a href=&quot;http://nodejs.org&quot;&gt;node.js&lt;/a&gt; environment that has become very popular over the past couple of years for web development. Being a web development language is not an official goal of Julia, but there is certainly no reason it can&amp;#39;t be used. For example, if server-side number crunching is one of the features your site needs, that part could be implemented in Julia and the rest of the application logic in node.js or your tool of choice.&lt;/p&gt;

&lt;p&gt;But back to sudoku. The Julia package &lt;a href=&quot;https://github.com/JuliaOpt/JuMP.jl&quot;&gt;JuMP&lt;/a&gt; is an algebraic modeling language for linear (and integer and quadratic) programming created by myself and the very talented &lt;a href=&quot;http://www.mit.edu/%7Emlubin/&quot;&gt;Miles Lubin&lt;/a&gt;. You should compare JuMP with tools like &lt;a href=&quot;http://code.google.com/p/pulp-or/&quot;&gt;PuLP&lt;/a&gt; and &lt;a href=&quot;http://www.ampl.com&quot;&gt;AMPL&lt;/a&gt;. If you aren&amp;#39;t familiar with algebraic modeling languages embedded in other languages, you can think of them as an embedded &lt;a href=&quot;http://en.wikipedia.org/wiki/Domain_specific_language&quot;&gt;domain specific language (DSL)&lt;/a&gt;. Julia&amp;#39;s fantastic &lt;a href=&quot;http://docs.julialang.org/en/latest/manual/metaprogramming/&quot;&gt;metaprogramming functionality&lt;/a&gt; has allowed us to create a particularily fast and expressive modeling language. I encourage you to read to the &lt;a href=&quot;https://jump.readthedocs.org/en/latest/jump.html&quot;&gt;documentation&lt;/a&gt;, but here is a taste of what it looks like.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;julia&quot;&gt;&lt;span class=&quot;lineno&quot;&gt; 1&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Assuming a solver has been previously installed, e.g. Cbc &lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 2&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JuMP&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 3&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt; 4&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt; SolveModel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initgrid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 5&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c&quot;&gt;# Feasibility problem, so sense not important&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 6&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt; 7&lt;/span&gt;   &lt;span class=&quot;c&quot;&gt;# Create the variables&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 8&lt;/span&gt;   &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;defVar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 9&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;10&lt;/span&gt;   &lt;span class=&quot;c&quot;&gt;# ... snip other constraints ...&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;11&lt;/span&gt;   &lt;span class=&quot;c&quot;&gt;# Constraint 4 - Only one value in each cell&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;12&lt;/span&gt;   &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;13&lt;/span&gt;     &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;14&lt;/span&gt;       &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addConstraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;15&lt;/span&gt;     &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;16&lt;/span&gt;   &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;17&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;18&lt;/span&gt;   &lt;span class=&quot;c&quot;&gt;# ... snip initial solution constraints ...&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;19&lt;/span&gt;   &lt;span class=&quot;c&quot;&gt;# Solve it (default solver is CBC)&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;20&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;21&lt;/span&gt;   
&lt;span class=&quot;lineno&quot;&gt;22&lt;/span&gt;   &lt;span class=&quot;c&quot;&gt;# Check solution&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;23&lt;/span&gt;   &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Infeasible&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;24&lt;/span&gt;     &lt;span class=&quot;nb&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;No solution found!&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;25&lt;/span&gt;   &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;26&lt;/span&gt;     &lt;span class=&quot;n&quot;&gt;mipSol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;27&lt;/span&gt;     
&lt;span class=&quot;lineno&quot;&gt;28&lt;/span&gt;     &lt;span class=&quot;n&quot;&gt;sol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;29&lt;/span&gt;     &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;30&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;31&lt;/span&gt;         &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;32&lt;/span&gt;           &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mipSol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.9&lt;/span&gt;  &lt;span class=&quot;c&quot;&gt;# mipSol is stored as floats&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;33&lt;/span&gt;             &lt;span class=&quot;n&quot;&gt;sol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;34&lt;/span&gt;           &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;35&lt;/span&gt;         &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;36&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;37&lt;/span&gt;     &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;38&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;39&lt;/span&gt;     &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sol&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;40&lt;/span&gt;   &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;41&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Line 7 creates our variable &lt;em&gt;x&lt;/em&gt; with three indices over the range 1 to 9, and enforces integrality. &lt;code&gt;@defVar&lt;/code&gt; is a macro, not a function, which lets it create a variable &lt;code&gt;x&lt;/code&gt; in the local scope. I have removed the other constraints for brevity and left the constraint that enforces that each cell contains only one value. Note the correspondance between the mathematical notation (&amp;quot;for all rows, for all columns&amp;quot;) and the &lt;code&gt;for&lt;/code&gt; loops (lines 11 and 12). &lt;code&gt;@addConstraint&lt;/code&gt; (line 13) is another macro that facilitates the efficient storage of the constraint as a sparse vector, and matches the mathematical description very closely. On line 19 we solve the model with the default solver &lt;a href=&quot;https://projects.coin-or.org/Cbc&quot;&gt;COIN-OR CBC&lt;/a&gt; - an open-source integer programming solver. As a side note, Julia/JuMP also has interfaces to GLPK (open-source) and Gurobi (closed-source). Finally, we pull the solution back from the solver (if a feasible solution could be found) as a three-dimensional matrix of 0s and 1s which we convert to a two-dimensional vector of 1-to-9s (lines 27 to 36).&lt;/p&gt;

&lt;p&gt;If you are interested in how macros and metaprogramming offer up new possibilities for optimization, operations research, and modelling languages, check out our &lt;a href=&quot;http://www.optimization-online.org/DB_FILE/2013/05/3883.pdf&quot;&gt;paper&lt;/a&gt;.&lt;/p&gt;

&lt;h2&gt;SaaS == Sudoku-as-a-service?&lt;/h2&gt;

&lt;p&gt;Now we can solve sudoku puzzles, we should share this functionality with the world. The best way to get started with creating a web service is to use the &lt;a href=&quot;https://github.com/hackerschool/HttpServer.jl&quot;&gt;HttpServer.jl&lt;/a&gt; package, a package made at &lt;a href=&quot;https://www.hackerschool.com/&quot;&gt;Hacker School&lt;/a&gt;. Documentation is pretty scarce at this point, but hopefully by inspecting the relatively short code and looking at some examples you can get started. &lt;/p&gt;

&lt;p&gt;I bundled my sudoku solver with a server in &lt;a href=&quot;https://github.com/IainNZ/SudokuService&quot;&gt;SudokuService&lt;/a&gt;. This kinda brings me back to why I used integer programming - to demonstrate that you can make pretty complex web-capable number crunching applications with relative ease. Check out &lt;code&gt;server.jl&lt;/code&gt; in the repository - its pretty straightforward and most of the work is input validation. The form of a query is &lt;code&gt;/sudoku/123...123&lt;/code&gt; or &lt;code&gt;/sudoku/123...123/pretty&lt;/code&gt; for human-readable response. There should be 81 numbers, one for each cell of the 9x9 sudoku board, row-wise. A zero indicates a blank. Heres a taster of the server code:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;julia&quot;&gt;&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HttpServer&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Load the Sudoku solver&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;sudoku.jl&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Build the request handler&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;http&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HttpHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Response&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ismatch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;^/sudoku/&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# Expecting 81 numbers between 0 and 9&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;reqsplit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;/&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# ...snip validation...#&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;probstr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reqsplit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;probstr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;81&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;400&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Error: expected 81 numbers.&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    
    &lt;span class=&quot;c&quot;&gt;# Convert string into numbers, and place in matrix&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# Return error if any non-numbers or numbers out of range detected&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;prob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;probstr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;422&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Error: number out of range 0:9.&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;prob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;422&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Error: couldn&amp;#39;t parse numbers.&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;# Attempt to solve the problem using integer programming&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;sol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SolveModel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prettyoutput&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# Human readable output&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;&amp;lt;table&amp;gt;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;&amp;lt;tr&amp;gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;&amp;lt;td&amp;gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;&amp;lt;/td&amp;gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;&amp;lt;/tr&amp;gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;&amp;lt;/table&amp;gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# Return solution like input&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;422&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Error: coudn&amp;#39;t solve puzzle.&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# Not a valid URL&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;404&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Boot up the server&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;server&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Server&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;server&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;Try it yourself!&lt;/h2&gt;

&lt;p&gt;Julia is still growing (rapidly) - I suggest grabbing the 0.2 pre-release and having a bit of patience in case of strange errors! You may also see some warnings regarding deprecation - hopefully they&amp;#39;ll be cleaned up soon once we reach version 0.2 for Julia and have a chance to go back and tidy up all the packages. Instructions for installing everything are in &lt;code&gt;README.md&lt;/code&gt;. I encourage you to check it out for yourself, and maybe extend it.  Some ideas:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Implement a pure-Julia sudoku solver and benchmark performance against the MIP solver.&lt;/li&gt;
&lt;li&gt;Generalize the code to accept and solve n-by-n sudoku problems&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Let me know how that goes by contacting me at idunning AT mit.edu or &lt;a href=&quot;https://www.twitter.com/iaindunning&quot;&gt;@iaindunning&lt;/a&gt;.&lt;/p&gt;
</description>
				<pubDate>Sun, 15 Sep 2013 08:00:00 -0400</pubDate>
				<link>http://iaindunning.com/2013/sudoku-as-a-service.html</link>
				<guid isPermaLink="true">http://iaindunning.com/2013/sudoku-as-a-service.html</guid>
			</item>
		
			<item>
				<title>SimplexJS</title>
				<description>&lt;p&gt;&lt;strong&gt;SimplexJS&lt;/strong&gt; is a Javascript library that solves &lt;a href=&quot;http://en.wikipedia.org/wiki/Linear_programming&quot;&gt;linear programming problems&lt;/a&gt; (LPs) and &lt;a href=&quot;http://en.wikipedia.org/wiki/Linear_programming#Integer_unknowns&quot;&gt;mixed-integer linear programming problems&lt;/a&gt; (MILPs) right in your browser. I&amp;#39;m not sure if this is particularily useful for any industrial application, but was fun to make, and could be used for teaching. It solves linear programs using the &lt;a href=&quot;http://en.wikipedia.org/wiki/Simplex_algorithm&quot;&gt;Simplex&lt;/a&gt; method, and uses branch-and-bound to solve problems with integer variables. LPs must be provided as dense matrices and vectors, in the following form:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;minimize &lt;strong&gt;c&lt;/strong&gt; . &lt;strong&gt;x&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;subject to A &lt;strong&gt;x&lt;/strong&gt; = &lt;strong&gt;b&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;and &lt;strong&gt;l&lt;/strong&gt; &amp;lt;= &lt;strong&gt;x&lt;/strong&gt; &amp;lt;= &lt;strong&gt;u&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This implementation is about as basic as it gets, but is hopefully &amp;quot;correct&amp;quot;. The branch-and-bound solver might not be, and is certainly not very efficient. &lt;/p&gt;

&lt;h2&gt;Demo: Travelling Salesman Problem&lt;/h2&gt;

&lt;h3&gt;What is a &amp;quot;TSP&amp;quot;?&lt;/h3&gt;

&lt;p&gt;From the &lt;a href=&quot;http://www.tsp.gatech.edu/problem/index.html&quot;&gt;Georgia Institue of Technology website&lt;/a&gt;:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Given a collection of cities and the cost of travel between each pair of them, the traveling salesman problem, or TSP for short, is to find the cheapest way of visiting all of the cities and returning to your starting point. In the standard version we study, the travel costs are symmetric in the sense that traveling from city X to city Y costs just as much as traveling from Y to X.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3&gt;Integer Programming Formulation&lt;/h3&gt;

&lt;p&gt;Given our definition of a TSP from above, we can start formulating the problem as an integer program:&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/simplextspobj.png&quot; alt=&quot;Minimize&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Minimize&lt;/p&gt;&lt;/div&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/simplextspcon1.png&quot; alt=&quot;Must enter every city&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Must enter every city&lt;/p&gt;&lt;/div&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/simplextspcon2.png&quot; alt=&quot;Must leave every city&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Must leave every city&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;where our &lt;em&gt;xij&lt;/em&gt; is a binary (0 or 1) variable that says if we will go from city &lt;em&gt;i&lt;/em&gt; to city &lt;em&gt;j&lt;/em&gt; on our tour. We are dealing with just the case where the costs between cities are symmetric, that is &lt;em&gt;cij = cji&lt;/em&gt;, so this can be simplified considerably. The simplified IP for a 4 city problem would have:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;A variable xij for each link: (1,2) (1,3) (1,4) (2,3) (2,4) (3,4)&lt;/li&gt;
&lt;li&gt;A constraint for each city, that says each city must be visited and left:

&lt;ul&gt;
&lt;li&gt;x1,2 + x1,3 + x1,4 = 2&lt;/li&gt;
&lt;li&gt;x1,2 + x2,3 + x2,4 = 2&lt;/li&gt;
&lt;li&gt;x1,3 + x2,3 + x3,4 = 2&lt;/li&gt;
&lt;li&gt;x1,4 + x2,4 + x3,4 = 2&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;Try it out&lt;/h3&gt;

&lt;p&gt;So now we&amp;#39;ve got our integer programming formulation, let&amp;#39;s try it out on a problem. Click the Reset button below - the default configuration of cities should (magically) appear.&lt;/p&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;

&lt;canvas id=&quot;cityContainer&quot; width=&quot;400&quot; height=&quot;400&quot;
        onmousemove=&quot;moveHandler(event);&quot;
        onmousedown=&quot;mouseDownHandler(event);&quot;
        onmouseup=&quot;mouseUpHandler(event);&quot;
        onmouseout=&quot;mouseUpHandler(event);&quot;&gt;&lt;/canvas&gt;
&lt;br&gt;
&lt;input type=&quot;button&quot; value=&quot;Solve TSP using branch-and-bound&quot; onclick=&quot;javascript:SolveTSP()&quot;&gt;
&lt;input type=&quot;button&quot; value=&quot;Add city&quot; onclick=&quot;javascript:AddCity()&quot;&gt;
&lt;input type=&quot;button&quot; value=&quot;Reset&quot; onclick=&quot;javascript:ResetCities();&quot;&gt;

&lt;/div&gt;

&lt;p&gt;You can drag the cities around and re-solve, or add cities to make it more complex. When you are ready to move on, click the Reset button.&lt;/p&gt;

&lt;p&gt;You may notice that the solution is not quite right for certain arrangements. While each city is visited and left, the optimal solution was not a path through all the cities but instead two smaller paths. We can call these smaller tours &lt;em&gt;subtours&lt;/em&gt;, and the constraints necessary to eliminate them are called &lt;em&gt;subtour-elimination constraints&lt;/em&gt;.&lt;/p&gt;

&lt;h3&gt;Subtour-Elimination Constraints&lt;/h3&gt;

&lt;p&gt;For a better and more detailed explanation of this, check out the &lt;a href=&quot;http://www.tsp.gatech.edu/methods/opt/subtour.htm&quot;&gt;Georgia Tech&lt;/a&gt; website.&lt;/p&gt;

&lt;p&gt;To complete our integer programming formulation we need to add these subtour-elimination constraints. An example of a subtour elimination constraint for the 6 city problem shown above would be:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;x0,1 + x1,2 + x0,2 &amp;lt;= 2&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This says that no more than two of the arcs between the nodes (0,1,2) are allowed to be in the solution. Here is something to try: how many possible subtour-elimination constraints are there for this problem? The answer is big, and keeps getting bigger as the number of cities grows. It&amp;#39;d take a long time to just write out all those constraints, let alone solve it. And yet, people solve TSPs with integer programming - so whats the secret?&lt;/p&gt;

&lt;p&gt;Lets try adding that subtour-elimination constraint we worked out before:&lt;/p&gt;

&lt;p&gt;&lt;textarea id=&quot;subtoursEntry&quot; cols=&quot;80&quot; rows=&quot;10&quot;&gt;
// Insert subtour elimination constraints here. The model building code in 
// this webpage will evaluate the code in this box before solving, allowing
// use to tell it to add some extra constraints by saying which arcs are in
// each subtour.
// Remove the // from the start of the next line to add a constraint.
// subtours.push([ [[0,1], [0,2], [1,2]], 2 ]) // Adds  x01 + x02 + x12 &amp;lt;= 2
&lt;/textarea&gt;&lt;/p&gt;

&lt;p&gt;Have you followed the above instructions? Now re-solve the TSP above. Perfect!&lt;/p&gt;

&lt;p&gt;We only need one of the many possible subtour-elimination constraints to change our nearly-correct solution into the optimal solution. A very similar method was first used &lt;a href=&quot;http://www.tsp.gatech.edu/methods/dfj/index.html&quot;&gt;quite some time ago, in 1954&lt;/a&gt; to solve a problem with 49 cities! This way of solving a problem, by first solving a relaxed version of it and then adding constraints (or &amp;quot;cuts&amp;quot;) to improve the relaxation, is one of the techniques used to solve all sorts of integer programs.&lt;/p&gt;

&lt;h3&gt;Output from the Integer Progamming Solver&lt;/h3&gt;

&lt;p&gt;We can see what the solver is doing by looking at the output that appears below when we hit &amp;quot;Solve&amp;quot;.&lt;/p&gt;

&lt;p id=&quot;output&quot; style=&quot;font-family: monospace&quot;&gt;

&lt;/p&gt;

&lt;script type=&quot;text/javascript&quot; src=&quot;/images/SimplexJS.js&quot;&gt;&lt;/script&gt;

&lt;script type=&quot;text/javascript&quot;&gt;
var numCities = 6;
var cities = [  [ 50, 200],
                [100, 100],
                [100, 300],
                [300, 100],
                [300, 300],
                [350, 200]  ];
var curSolution = [];
var dragging = false;
var draggingIndex = -1;
var lastX = -1, lastY = -1;
var subtours = [];

function ResetCities(e)
{
    numCities = 6;
    cities = [  [ 50, 200],
                [100, 100],
                [100, 300],
                [300, 100],
                [300, 300],
                [350, 200]  ];
    curSolution = [];
    dragging = false;
    draggingIndex = -1;
    lastX = -1, lastY = -1;
    subtours = [];
    DrawCities();
}

function mouseDownHandler(e)
{
    var x = e.pageX - e.target.offsetLeft;
    var y = e.pageY - e.target.offsetTop;
    for(var i = 0; i &lt; numCities; i++) {
        var dist = (cities[i][0]-x)*(cities[i][0]-x) + (cities[i][1]-y)*(cities[i][1]-y);
        if (dist &lt;= 25*25) {
            dragging = true;
            lastX = x;
            lastY = y;
            draggingIndex = i;
        }
    }
}

function mouseUpHandler(e)
{
    dragging = false;
    lastX = -1;
    lastY = -1;
}

function moveHandler(e) {
    if (dragging) {
        var x = e.pageX - e.target.offsetLeft;
        var y = e.pageY - e.target.offsetTop;
        var deltaX = x - lastX;
        var deltaY = y - lastY;

        cities[draggingIndex][0] += deltaX;
        cities[draggingIndex][1] += deltaY;
 
        lastX = x;
        lastY = y;
        DrawCities();
    }
}

function AddCity() {
    numCities += 1;
    cities.push([Math.random()*400, Math.random()*400]);
    DrawCities();
}


function DrawCities() {
    var canv = document.getElementById(&quot;cityContainer&quot;);
    var ctxt = canv.getContext(&quot;2d&quot;);
    ctxt.fillStyle = &quot;#DDDDDD&quot;;
    ctxt.fillRect(0, 0, canv.width, canv.height);
    for (i = 0; i &lt; curSolution.length; i++) {
        ctxt.beginPath();
        ctxt.moveTo(cities[curSolution[i][0]][0], cities[curSolution[i][0]][1]);
        ctxt.lineTo(cities[curSolution[i][1]][0], cities[curSolution[i][1]][1]);
        ctxt.closePath();
        ctxt.strokeStyle = &quot;#FF0000&quot;;
        ctxt.stroke();

    }
    for (i = 0; i &lt; numCities; i++) {
        ctxt.beginPath();
        ctxt.arc(cities[i][0], cities[i][1], 20, 0, Math.PI * 2, false);
        ctxt.closePath();
        ctxt.strokeStyle = &quot;#000000&quot;;
        ctxt.stroke();
        ctxt.fillStyle = &quot;#0000FF&quot;;
        ctxt.fill();
        ctxt.fillStyle = &quot;#FFFFFF&quot;;
        ctxt.font = &quot;bold 12px sans-serif&quot;;
        ctxt.fillText(i.toString(), cities[i][0]-5, cities[i][1]+5);
    }
}

function SolveTSP() {

    document.getElementById(&quot;output&quot;).innerHTML = &quot;Starting SolveTSP()&lt;br&gt;&quot;

    // Load city locations, and calculate distances
    var Cij = new Array(numCities);
    for (i = 0; i &lt; numCities; i++) {
        Cij[i] = new Array(numCities);
        for (j = 0; j &lt; numCities; j++) {
            Cij[i][j] = Math.sqrt( (cities[i][0] - cities[j][0]) * (cities[i][0] - cities[j][0])
                                  +(cities[i][1] - cities[j][1]) * (cities[i][1] - cities[j][1]))
        }
    }

    // Create the IP
    var tsp = {};

    // Create cost vector, map arc to column
    // x00 x01 x02 x03 x04 x05 x10 x11 ...
    tsp.n = (numCities)*(numCities-1)/2;
    tsp.c = new Array(tsp.n);
    var col = new Array(), z=0;
    for (i = 0; i &lt; numCities; i++) {
        for (j = i+1; j &lt; numCities; j++) {
            col[[i,j]] = z;
            col[[j,i]] = z;
            tsp.c[z] = Cij[i][j];
            z++;
        }
    }

    // Create each row of A and b
    tsp.m = numCities;
    tsp.A = new Array(tsp.m);
    tsp.b = new Array(tsp.m);
    // Degree of each city = 2 (no constraint for last city)
    for (i = 0; i &lt; numCities; i++) {
        tsp.A[i] = new Array(tsp.n);
        for (j = 0; j &lt; tsp.n; j++) tsp.A[i][j] = 0;
        for (j = 0; j &lt; numCities; j++) {
            if (i!=j) tsp.A[i][col[[i,j]]] = 1;
        }
        tsp.b[i] = 2;
    }

    // Set variable bounds and type
    tsp.xLB = new Array(tsp.n);
    tsp.xUB = new Array(tsp.n);
    tsp.xINT = new Array(tsp.n);
    for (i = 0; i &lt; tsp.n; i++) {
        tsp.xLB[i] = 0; tsp.xUB[i] = 1; tsp.xINT[i] = true;
    }


    // Add subtours
    subtours = []
    eval(document.getElementById(&quot;subtoursEntry&quot;).value);
    for (st = 0; st &lt; subtours.length; st++) {
        stArcs = subtours[st][0];
        stSize = subtours[st][1];
        // Add the slack for this subtour
        tsp.n += 1;
        tsp.xLB.push(0);
        tsp.xUB.push(Infinity);
        tsp.c.push(0);
        tsp.xINT.push(false);
        // Modify existing constraints
        for (i = 0; i &lt; tsp.m; i++) tsp.A[i].push(0);
        // Add new constraint
        tsp.m += 1;
        tsp.b.push(stSize);
        tsp.A.push(new Array());
        for (i = 0; i &lt; tsp.n; i++) tsp.A[tsp.m-1][i] = 0;
        for (starc = 0; starc &lt; stArcs.length; starc++) {
            i = stArcs[starc][0];
            j = stArcs[starc][1];
            tsp.A[tsp.m-1][col[[i,j]]] = 1;
        }
        tsp.A[tsp.m-1][tsp.n-1] = 1; // slack
    }

    // Solve
    var log = [];
    SimplexJS.MAXITERATIONS = 1000;
    SimplexJS.SolveMILP(tsp, 20, log);
    var logstr = &quot;&quot;;
    for (i = 0; i &lt; log.length; i++) logstr += log[i] + &quot;&lt;br&gt;&quot;
    document.getElementById(&quot;output&quot;).innerHTML = logstr

    // Display answer
    if (tsp.status == SimplexJS.OPTIMAL) {
        //var out = &quot;Solved!&lt;br&gt;Size of branch-and-bound tree was &quot; + tsp.nodeCount.toString() + &quot; (limit: 20)&lt;br&gt;&quot;;
        //out += tsp.n.toString() + &quot; variables, &quot; + tsp.m.toString() + &quot; constraints.&lt;br&gt;&quot;;
        curSolution = [];
        for (i = 0; i &lt; numCities; i++) {
            for (j = i+1; j &lt; numCities; j++) {
                if (tsp.x[col[[i,j]]]) {
                    //out += &quot;Arc from City &quot; + (i+1).toString() + &quot; to City &quot; + (j+1).toString() + &quot;&lt;br&gt;&quot;;
                    curSolution.push([i,j]);
                }
            }
        }
    }
    DrawCities();

}

DrawCities();
&lt;/script&gt;
</description>
				<pubDate>Sun, 08 Sep 2013 08:00:00 -0400</pubDate>
				<link>http://iaindunning.com/2013/simplexjs.html</link>
				<guid isPermaLink="true">http://iaindunning.com/2013/simplexjs.html</guid>
			</item>
		
			<item>
				<title>An Icelandic Adventure</title>
				<description>&lt;p&gt;In August 2012 I traveled to Iceland with my friends John and Alex. We were there for a week in total, and saw a multitude of amazing things.  While we didn&amp;#39;t want to make an exact plan of what to do, we also didn&amp;#39;t want to waste time needlessly backtracking. While Googling was useful, the most useful things were the two other itineraries provided by friends. I thought I&amp;#39;d return the favor to the world-at-large by providing a rough sketch of what we ended up doing - mistakes and all. I would add one caution: depending on what time of year you go, some things on this list may be impractical or physically impossible due to the weather or number of daylight hours. We had a fantastic time, and I hope you will too if you get the chance to go!&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandgroupthreejohns.jpg&quot; alt=&quot;The team at the top of the 'Three Johns'&quot;&gt;&lt;p class=&quot;caption&quot;&gt;The team at the top of the 'Three Johns'&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;I wrote most of this post immediately after getting back in a series of emails. I&amp;#39;ve gone back and edited them to clarify and add more details, but it has been almost a year since the trip so I may have got some details wrong. All the fantastic photos in this post were taken by Alex.&lt;/p&gt;

&lt;h2&gt;Before Iceland (Boston, Saturday)&lt;/h2&gt;

&lt;p&gt;Our flight was at about 9:30 pm with &lt;a href=&quot;http://www.icelandair.us/&quot;&gt;Icelandair&lt;/a&gt; on a plane named &lt;a href=&quot;http://en.wikipedia.org/wiki/Hekla&quot;&gt;Hekla&lt;/a&gt;, a very active volcano known as the &amp;quot;Gateway to Hell.&amp;quot; We bought direct round-trip tickets in mid-April for $600 from &lt;a href=&quot;http://www.studentuniverse.com/&quot;&gt;StudentUniverse&lt;/a&gt;. We also rented a SUV/4WD/&amp;quot;4x4&amp;quot; (from &lt;a href=&quot;http://www.goiceland.com/&quot;&gt;Go Iceland&lt;/a&gt;) for 138670 ISK which is roughly US$1150.&lt;/p&gt;

&lt;h2&gt;Sunday (South West Iceland)&lt;/h2&gt;

&lt;p&gt;We arrived at about 6:30 am at &lt;a href=&quot;http://en.wikipedia.org/wiki/Keflavik_airport&quot;&gt;Keflavik Airport&lt;/a&gt;. Passport control is very relaxed - walk up to a window, asked simply &amp;quot;staying?&amp;quot;, &amp;quot;yes&amp;quot;, stamp, done. It is part of the &lt;a href=&quot;http://en.wikipedia.org/wiki/Schengen_Area&quot;&gt;Schengen Area&lt;/a&gt; so if you have a European passport you probably don&amp;#39;t even need to do that. Someone from the rental car company was there at the arrival area to take us a few minutes away to the rental car company base. One of my friends had cash she needed to exchange for kronor but the rental car guy said it&amp;#39;d be better rates downtown than at the airport. While that sounded totally reasonable at the time, not doing it then turned out to be a mistake, as nothing in Reykjavik was open at that time (or in general) on a Sunday!&lt;/p&gt;

&lt;p&gt;We left the rental car base and headed down the highway to the &lt;a href=&quot;http://www.bluelagoon.com/&quot;&gt;Blue Lagoon&lt;/a&gt;, which is a collection of geothermal pools that are a great light blue color in the middle of a big lava field between Keflavik and Reykjavik. The rock was covered in really thick moss, that was very soft. Unfortunately we got there before it opened (9 am), so we continued to Reykjavik. By this time I&amp;#39;m really tired (can&amp;#39;t sleep on planes) and hungry too. Unfortunately pretty much nothing seemed open downtown! Eventually we found a 24 hour supermarket, and also got some cash from an ATM. In general I was fine using a Visa card for everything and hardly needed the cash. One catch: like most of Europe, credit cards use chips and have pins. This means that unless your credit card has a PIN, you are not going to be able to use unattended things like gas pumps. My Mastercard debit card worked fine though, because it has a PIN, so all was not lost.&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandbluelagoon.jpg&quot; alt=&quot;The Blue Lagoon&quot;&gt;&lt;p class=&quot;caption&quot;&gt;The Blue Lagoon&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;After all that drama we headed back to the Blue Lagoon, which I really enjoyed and was a great temperature. Its not cheap, so if you are budget conscious you might want to hold off on it. There are other hot springs around the country that are cheaper, but might be a bit off the beaten trail. In the early afternoon we headed back through the outskirts of Reykjavik on our way out into the countryside. We were pretty hungry again and finding places to eat that weren&amp;#39;t a chain of some sort proved difficult - we ended up at a combination KFC/Taco Bell!&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandkerid.jpg&quot; alt=&quot;Me on the edge of Kerið&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Me on the edge of Kerið&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;Our next goal was &lt;a href=&quot;http://en.wikipedia.org/wiki/Geysir&quot;&gt;Geysir&lt;/a&gt;. If you look at routes on Google Maps/GPS you will see a couple of routes - we took the southern one. Along the way we stumbled upon &lt;a href=&quot;http://en.wikipedia.org/wiki/Keri%C3%B0&quot;&gt;Kerið&lt;/a&gt;, a beautiful volcanic crater just sitting by the side of the road. Geysir is both a small area and the name of a geyser. There is campsite right next to the geyser area that costs about $10/person/night, and had nice bathroom facilities. There isn&amp;#39;t much man-made in the area except a hotel/tourist center across the road from the campsite and geysers. We had dinner at the cafe there; I had kjötsúpa (traditional Icelandic lamb stew/soup), which was probably the most expensive soup I&amp;#39;ve ever had, but it &lt;em&gt;was&lt;/em&gt; tasty. After dinner, we checked out the geysers. Geysir itself doesn&amp;#39;t explode anymore but its neighbor &lt;a href=&quot;http://en.wikipedia.org/wiki/Strokkur&quot;&gt;Strokkur&lt;/a&gt; did blow every few minutes, quite impressively. We clambered up a big hill nearby and were rewarded with a great view. The light levels didn&amp;#39;t really change much between 5pm and 9pm, so we were active until kinda late. Overnight the weather deteriorated and it rained. I slept very solidly - exhausted. The temperature in late August was pretty consistently around 10C, plus/minus 5C, so keep in mind what kind of sleeping bag you bring, or what you wear to sleep - I was a dumbass and didn&amp;#39;t really wear enough for the thinness of my sleeping bag, got cold without realizing it, and woke up feeling not-very-good!&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandstrokkur.jpg&quot; alt=&quot;A great shot of Strokkur erupting&quot;&gt;&lt;p class=&quot;caption&quot;&gt;A great shot of Strokkur erupting&lt;/p&gt;&lt;/div&gt;

&lt;h2&gt;Monday (South West to North West)&lt;/h2&gt;

&lt;p&gt;On the first night we slept in two tents, which were both a bit soggy. Our solution was to shove them into the trunk and back seat, crank up the heat, and try to dry them out a bit. Our next goal was to get to &lt;a href=&quot;http://en.wikipedia.org/wiki/Thingvellir&quot;&gt;Þingvellir (Thingvellir)&lt;/a&gt; is the traditional home of the &lt;a href=&quot;http://en.wikipedia.org/wiki/Althing&quot;&gt;Alþingi (Althing)&lt;/a&gt;, which was the Icelandic seat of government for a very long time. On the way we saw a hill overlooking a lake that we climbed. It turned out to be a lot taller than it looked, and we got blasted by wind that was so strong the rain felt like hail.&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandthingcrevass.jpg&quot; alt=&quot;Rough terrain&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Rough terrain&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;Thingvellir is quite a cool location. It sits right on the tectonic plate boundaries, so lots of long crevasses of various depths. There was not really any ruins to see - apparently the volcanic nature of Iceland is not suited for preserving historical structures! On the way out of the area we pulled over and clambered over some fields to check out the top of a waterfall - the water was beautiful, clear and cold. I didn&amp;#39;t drink from it (paranoid), but Alex and John did.&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandthingwaterfall.jpg&quot; alt=&quot;Alex and John standing by the waterfall&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Alex and John standing by the waterfall&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;We set course for the western fjords, which took us along unpaved roads through a countryside of grand landscapes. We stopped at a gas station for lunch in &lt;a href=&quot;http://en.wikipedia.org/wiki/Borgarnes&quot;&gt;Borgarnes&lt;/a&gt; (after another unsuccessful attempt to find an &amp;quot;actual&amp;quot; restaurant). While there I started reading an English language newspaper that had GPS coordinates for some natural hot springs that were relatively nearby. Luckily I saved the newspaper, so I&amp;#39;ve still got the co-ordinates: the first was the Sturlungalaug pool (64.52174, -22.17024) and the second was the Landbrotalaug pool (64.49933, -22.19110). So we plugged them and headed off. The pools turned out to be not that great, but the journey was amazing - we headed way off the beaten path, saw some landscapes that wouldn&amp;#39;t look out of place on Mars, and some that were quite green and grassy for Iceland. At the first spring we found a French family having a picnic, but it was too hot to get in the water. The second spring was tiny, and had perhaps seen better days.  On our way out the area we ended up finding another waterfall that was comprised of three small falls, which we named the &amp;quot;Three Johns&amp;quot; for reasons best left unsaid on the internet. I did have a drink of the water here, and it was great, although even better tasting free-flowing water was to come. On the way off the road to the waterfall I nearly ripped the bottom of the car out on a rock (or at least thats what it sounded like) - a good lesson to learn early because we&amp;#39;d be going off-road a lot more later.&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandwestred.jpg&quot; alt=&quot;Red soil - iron?&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Red soil - iron?&lt;/p&gt;&lt;/div&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandthreejohns.jpg&quot; alt=&quot;The Three Johns&quot;&gt;&lt;p class=&quot;caption&quot;&gt;The Three Johns&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;We kept making our way north and ended up in &lt;a href=&quot;http://en.wikipedia.org/wiki/Bl%C3%B6ndu%C3%B3s&quot;&gt;Blönduós&lt;/a&gt;. The clouds had come in very very low and we were trying to find a campground. Perhaps fortunately we didn&amp;#39;t find it and instead found a place that had little huts for a very reasonable price (~$20 per person) - I think it is &lt;a href=&quot;http://goo.gl/maps/tm6JV&quot;&gt;here&lt;/a&gt;. The only place to eat in town that was open was a  restaurant, which apparently was called &lt;a href=&quot;http://www.potturinn.is/&quot;&gt;Potturinn og Pannan&lt;/a&gt;. As with most restaurants we did find in Iceland it was pretty pricey. However it did serve seal, which John and I decided we had to try given the opportunity. It was quite salty and dark, and looked a bit like steak. I didn&amp;#39;t really know how to describe it, but the waitress said it was like liver. Neither John nor I really liked it that much, so I&amp;#39;d probably never order it again, but it was worth trying!&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandblonduos.jpg&quot; alt=&quot;Our hut in Blonduous&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Our hut in Blonduous&lt;/p&gt;&lt;/div&gt;

&lt;h2&gt;Tuesday (North West to North East)&lt;/h2&gt;

&lt;p&gt;I couldn&amp;#39;t sleep so I got up early at walked out to the edge of the harbor in Blönduós - the current/tide was very strong, quite a sight to watch. The cloud was still low was the others got up and we set course for &lt;a href=&quot;http://en.wikipedia.org/wiki/Akureyri&quot;&gt;Akureyri&lt;/a&gt;, which is the biggest city in the north and I&amp;#39;d believe is the second biggest city in Iceland. The drive there was beautiful; the road runs between mountains and steep valleys, and as the cloud lifted it revealed some beautiful views. In Akureyri we were at a bit of a loss as to what to do. At a friend&amp;#39;s recommendation we checked out &lt;a href=&quot;http://www.tripadvisor.com/Restaurant_Review-g189954-d1103736-Reviews-Brynja-Akureyri_Northeast_Region.html&quot;&gt;Brynja&lt;/a&gt;, which sells delicious icecream that was somewhat like a thicker-than-ususal soft serve. I recommend getting candy mixed in!&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandtoakyu.jpg&quot; alt=&quot;On the way to Akureyri&quot;&gt;&lt;p class=&quot;caption&quot;&gt;On the way to Akureyri&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;After getting some maps from a visitors center, we departed Akureyri. Our general destination was the &lt;a href=&quot;http://en.wikipedia.org/wiki/Myvatn&quot;&gt;Mývatn&lt;/a&gt; area, which was described on main map as follows: &amp;quot;few words do justice to this place, it is like being on another planet&amp;quot;. Along the way we saw &lt;a href=&quot;http://en.wikipedia.org/wiki/Godafoss&quot;&gt;Goðafoss&lt;/a&gt;, which was a grand waterfall. It is very wide, and makes a fantastic sound. Mývatn is a big lake area with volcanic rock around it - although most of that volanic terrain was on the far side of the lake, so at first I was a bit disappointed (relatively). On the far side we saw more of the rocky volcanic plains and moss. We headed off down a little unpaved road but reached a gate. We climbed up some rocks and saw a cool looking volcano which turned out to be a scoria-ish cone, which we climbed up - no greenery to be seen, just rock! This was &lt;a href=&quot;http://en.wikipedia.org/wiki/Hverfjall&quot;&gt;Hverfjall&lt;/a&gt;, and you can see it on &lt;a href=&quot;http://goo.gl/maps/8aI4V&quot;&gt;Google Maps really clearly&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandgodafoss.jpg&quot; alt=&quot;John and I looking over Godafoss&quot;&gt;&lt;p class=&quot;caption&quot;&gt;John and I looking over Godafoss&lt;/p&gt;&lt;/div&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandbigcrater.jpg&quot; alt=&quot;Couldn't capture the whole crater in a single shot&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Couldn't capture the whole crater in a single shot&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;From the top we could see steam billowing in the distance. This was coming from another hot spring similar to the Blue Lagoon, but a bit less touristy, called &lt;a href=&quot;http://www.jardbodin.is/en/&quot;&gt;Jarðböðin við Mývatn&lt;/a&gt;. We figured we&amp;#39;d already done that, so didn&amp;#39;t go in, but thought that it may have been a better idea to skip going into the Blue Lagoon and go here instead. Just over a hill from there is a volcanic hotspot (Hverarönd) that is reminiscent of &lt;a href=&quot;http://en.wikipedia.org/wiki/Rotorua&quot;&gt;Rotorua&lt;/a&gt;, New Zealand. Complete with boiling mud pools and steaming sulfur-yellow vents, its quite fun, but I think was particularly exciting for John, who hadn&amp;#39;t really seen anything like it before.&lt;/p&gt;

&lt;p&gt;Next was a decent drive to what would end up being one of my favorite things, the &lt;a href=&quot;http://en.wikipedia.org/wiki/Dettifoss&quot;&gt;Dettifoss&lt;/a&gt; waterfall which was &lt;strong&gt;massive&lt;/strong&gt;. It is really in the middle of nowhere, and the GPS got very confused, possibly due to a new road. It got very bleak landscape-wise, just fairly flat and not much life - the recurring volcanic events periodically seem to reset life in Iceland back to moonscape like conditions. The waterfall was definitely worth the trip though - a tremendous amount of water flowing over it and a big drop. The mist that was thrown up obscured the bottom, making it hard to figure out exactly how tall it was.&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelanddettifoss.jpg&quot; alt=&quot;Dettifoss - pictures don't do it justice&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Dettifoss - pictures don't do it justice&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;We were not totally clear on where to go next. One of my friends really wanted to see puffins, and we thought we might see some in the very north-east, based on some tourist maps we had. Besides, we needed a place to sleep, so we set course for &lt;a href=&quot;http://en.wikipedia.org/wiki/%C3%9E%C3%B3rsh%C3%B6fn&quot;&gt;þórshöfn&lt;/a&gt; which is pretty much at the &lt;a href=&quot;http://goo.gl/maps/SdrTQ&quot;&gt;end of the world&lt;/a&gt;. Getting out of the Dettifoss area required first driving over a very rough road with lots of blind hills and turns for something like 30 to 45 minutes - needed that 4WD! At one point came across a tour bus coming the other way, which seemed like madness given the road condition. After we got out of that we had dinner at a gas station/diner. Things soon got crazy when the GPS took us on a very rough road over a mountain, which looked like a normal-ish road on the paper map and was the only option that wouldn&amp;#39;t add another hour travel time. Again I was the paranoid one - I wasn&amp;#39;t even sure it was a road! In fact, it had a farm gate tied up with rope blocking the entrance. The other two were keen, so we did it, and I&amp;#39;m glad we did. It soon got really spooky and you realized we were a long way from anyone and anywhere. It was also about 7 pm so still light but on its way out - when the cloud closed in it was quite intense. The sheep provided much merriment: a select few sheep couldn&amp;#39;t figure out that best way to get away from the car was &lt;em&gt;not&lt;/em&gt;, in fact, to run down the road in front of us. Since we seemed to be giving them such a workout, we called this &amp;quot;&lt;a href=&quot;http://en.wikipedia.org/wiki/P90x&quot;&gt;P90X&lt;/a&gt;ing&amp;quot; the sheep! At one point the road was pretty washed out, requiring some careful maneuvering to avoid getting stuck. The highlight of this trip into the highlands for me was when we found what looked like an abandoned house, which was not an uncommon sight but more often along the coast. The windows were cracked and it definitely wasn&amp;#39;t lived in. The door was stuck so I kicked it open (!!!). It flew off its hinges and we went inside. The ground was covered in dead flies (the cold kills them I guess?) and there was a diary on a table as well as three really old looking mattresses. In the diary were occasional messages from passer-bys who had done the same thing.&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandhouse.jpg&quot; alt=&quot;Anyone home?&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Anyone home?&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;We ended up getting to þórshöfn without any additional drama. Its a pretty small town, with a campsite that was basic but nice enough. We were weighing up the possibility of staying in hostel that was apparently nearby. We drove out of town out on the peninsula to check it out, but it was pretty expensive per person and given that the campsite seemed OK so we drove back and camped. Unlike the first night, we shared the bigger tent, but like the first night, it rained. This wouldn&amp;#39;t have been an issue except that tent design was flawed and let water in through the zipper somehow, resulting in some wet feet! Overall though, given our lack of well-planned equipment, things went relatively well with regards to outdoor gear.&lt;/p&gt;

&lt;h2&gt;Wednesday (North East to South East)&lt;/h2&gt;

&lt;p&gt;On Wednesday morning we got up but had to wait for the grocery store to open before setting out. In search of the puffins, we drove to the end of the Langanes peninsula, which took a lot longer than I think we all thought because it was such a rough road. The road mostly ran alongside the coast, and was near sea-level for large sections. For some reason the coast was littered with debris, wrecked ships and miscellaneous buoys and timber. At the end was a lighthouse, a lot of seagulls, and beautiful desolation. We were slightly below the Arctic Circle, and felt very alone. That is until we realized suddenly that someone seemed to be in the lighthouse, because there were shoes at the door, and Alex possibly heard noises, but it seemed crazy because there was no vehicle there, and no sign of power generation. Very creepy... we decided to leave.&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelanddebris.jpg&quot; alt=&quot;Debris and dead ships line the coast&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Debris and dead ships line the coast&lt;/p&gt;&lt;/div&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandlighthouse.jpg&quot; alt=&quot;Not visible: one million seagulls&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Not visible: one million seagulls&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;As we returned to town, we made a detour down a turnoff and found the remnants of what was once a town called Skálar, which has a very &lt;a href=&quot;http://www.edgeofthearctic.is/local-pearls-and-attractions/skalar-at-langanes/&quot;&gt;interesting history&lt;/a&gt;. I kept a beautifully smoothed rock from there - my only souvenir apart from our annotated tourist maps. As we continued back we stopped briefly to walk in the ocean, which was as cold as you&amp;#39;d expect! All this took quite a bit of time, and we didn&amp;#39;t get back until near noon. We got food from a grocery store, including the fantastic Icelandic yoghurt s&lt;a href=&quot;http://en.wikipedia.org/wiki/Skyr&quot;&gt;kyr&lt;/a&gt;, which tasted great. John and I made salami sandwhiches, which due to our less-than-ideal diet of late tasted amazing. We tried to buy some beers for that night, but it turned out the liquor store was only open one hour per day... I must make a brief mention of our beer experience earlier.  On the first night, when we had the lamb soup in Geyser, Alex and John both got beers. Both were local lagers, but John&amp;#39;s was a lower alcohol content and didn&amp;#39;t taste very good. Alex&amp;#39;s one was OK, but not great. To me at least, matter of taste.&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandocean.jpg&quot; alt=&quot;The logic was, when will we next get to walk in this ocean?&quot;&gt;&lt;p class=&quot;caption&quot;&gt;The logic was, when will we next get to walk in this ocean?&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;The rest of the day involved driving down the eastern coast towards &lt;a href=&quot;http://en.wikipedia.org/wiki/Hofn&quot;&gt;Höfn&lt;/a&gt;, which is where we were planning to launch our trip to the glacier from the next day. Compared to our adventures so far it was relatively uneventful, but we did stop to admire the regular waterfalls and seascapes. Mostly we were back on Highway 1, which we had left the previous day to go to Dettifoss. It was good to be back on it! On the way down the coast we were on the lookout for a liquor store, which we eventually found. We were getting some beer (which turned out to be decent) and heard some Americans asking about something called the &amp;quot;Black Death&amp;quot;, which turned out to be &lt;a href=&quot;http://en.wikipedia.org/wiki/Brennivin&quot;&gt;Brennivín&lt;/a&gt;. So we got some of that too - strong, interesting taste, like rye bread liquor.&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandcoastline.jpg&quot; alt=&quot;The eastern coastline&quot;&gt;&lt;p class=&quot;caption&quot;&gt;The eastern coastline&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;When we got to Höfn, the hostel was completely booked out. Fortunately a nearby campground still had a couple of huts available. It was pretty pricey, but given we didn&amp;#39;t pay for the campground the previous night (didn&amp;#39;t figure out how to!), we figured it averaged out OK. After getting settled, we headed out to find somewhere to eat. We again had a bit of trouble finding a place that wasn&amp;#39;t fast-foody but was not super expensive. After driving around for a bit we ended up at the first restaurant we had found. John and I had the lamb, which was delicious, but maybe not as good as New Zealand lamb (biased!). After dinner we headed back to the hut and played cards and drank our beer and brennivin - it was a good night!&lt;/p&gt;

&lt;h2&gt; Thursday (South East to South)&lt;/h2&gt;

&lt;p&gt;We left Höfn at about 9am, a bit short on food at this point, and headed towards &lt;a href=&quot;http://en.wikipedia.org/wiki/J%C3%B6kuls%C3%A1rl%C3%B3n&quot;&gt;Jökulsárlón&lt;/a&gt; - the famous glacial lake. The lake is emptying steadily into the sea , and is filled with chunks of ice breaking off the end of the glacier! The ice itself is flowing out to sea too, so you&amp;#39;ll see bits of ice sailing off into the ocean to meet their fate. There were a lot of people there, more tourists in one place than we&amp;#39;d seen since the Blue Lagoon at the start actually. We considered going on a boat tour around the lagoon, but passed, partly because money concerns and partly because we planned to do a glacier walk and didn&amp;#39;t want to miss a place on that. This was probably the right choice, because the glacier was so awesome that it blew everything else away. The ice was very blue looking, apparently because it has very few imperfections/air bubbles in it.&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandicedragon.jpg&quot; alt=&quot;The ice dragon lurks beneath the surface (John managed to hit it with a rock!)&quot;&gt;&lt;p class=&quot;caption&quot;&gt;The ice dragon lurks beneath the surface (John managed to hit it with a rock!)&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;We got back on the road after not too long at the lake and headed to &lt;a href=&quot;http://en.wikipedia.org/wiki/Skaftafell&quot;&gt;Skaftafell&lt;/a&gt;, where all the &lt;a href=&quot;http://en.wikipedia.org/wiki/Vatnaj%C3%B6kull_National_Park&quot;&gt;Vatnajökull&lt;/a&gt; glacier walks seemed to be based. We had picked up some brochures in Höfn and picked one that seemed the &lt;a href=&quot;http://www.mountainguides.is/day-tours/glacier-tours/from-skaftafell/glacier-adventure/&quot;&gt;best value for money&lt;/a&gt;. We got there around 11:30 and got a spot on the 1:30 tour, paid, found out that the Icelandic guide had been to New Zealand for long periods - she even spoke a bit like a Kiwi. We then looked for food, but didn&amp;#39;t fancy the overpriced cafe. We looked at a map for the nearest town but nothing was close enough, but eventually we saw a food symbol on one of our maps and headed for it - turned out to be a gas station with a big cafeteria. Ended up having vegetable soup and potato gratin, didn&amp;#39;t fancy the prices for everything else. Filled us up with warmth, and kept us going for the afternoon - we picked up a few extra snacks too while we could.&lt;/p&gt;

&lt;p&gt;Got back to start of glacier walk, they took one look at our sneakers and told us to hire boots. So we did, they were really good ones too. I had forgotten to bring gloves (to be precise, I for some reason didn&amp;#39;t think I&amp;#39;d need them at that time of year so consciously decided to not bring them!) and they didn&amp;#39;t have any left so I went gloveless. Thankfully it wasn&amp;#39;t raining, as I just had two hoodies and a pair of jeans on, which wouldn&amp;#39;t have done well. If you had any kind of water-resistant outerwear it would be a good idea to bring it. Anyway, the weather was weirdly good (according to them), so we got issued our crampons, ice pick, harness, and helmet, and set off in a van to the foot of the glacier. Its hard for me to figure exactly where we were on Google Maps but I&amp;#39;m 99% sure &lt;a href=&quot;https://maps.google.com/maps?q=iceland&amp;amp;hl=en&amp;amp;ll=64.006387,-16.875034&amp;amp;spn=0.064626,0.096645&amp;amp;sll=42.37839,-71.112214&amp;amp;sspn=0.108928,0.096645&amp;amp;t=w&amp;amp;hnear=Iceland&amp;amp;z=13&quot;&gt;this&lt;/a&gt; is the right place, one of the tongues of the glacier.&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandglacierbefore.jpg&quot; alt=&quot;Getting ready&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Getting ready&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;We walked out for a bit over exposed rock towards the glacier, which was somewhat &amp;quot;dirty&amp;quot; on the surface because of the ash trapped in it, especially at the base where it was melting the most. We went down a steepish climb with a rope to help, then put on our crampons and headed on to the ice, which was initially quite rough. Got showed how to use crampons to go up and down slopes, and got told that the glacier has definitely been melting faster in the past few years, and that in the act of flying there to see it, we had contributed to it - food for thought. As we headed up the tongue of glacial ice I found it to be pretty easy going once I got the hang of it, not too strenuous at all. It wasn&amp;#39;t even that cold, and in fact I needed to unzip jackets eventually because I was getting too warm! The harnesses we were wearing turned out to be so we could be attached to a rope at a couple of bits where we had to walk between two crevasses. Apparently the ice crevasses are dangerous in a way I had never considered - if you fall in one, your body heat warms the ice enough for you to slip further down and you can eventually suffocate! There were also little streams everywhere that disappeared into seemingly bottomless holes - apparently there is flowing water all under the glacier. At one point our guide encouraged us to drink some of the melt - it was unique and very tasty. If you scraped the surface of the ice, which was white with sometimes ashy black ribbons, it was blue underneath - very pure ice. The ice axe/pick things we were carrying were pretty much for show, but were pretty satisfying to swing around all the same. I cut my finger at one point somehow (not from the pick) and it bled a surprising amount for a shallow cut - I probably left blood all over the glacier... We got a decent way up the tongue, the group was all pretty fit and we maintained a good pace. On the way up it seemed like the guide was following a planned path, but on the way down we just sort of wandered down any old way, which required some backtracking, which I thought was cool. We had to walk single file to stop people straying into crevasses. I think we were all glad we did the 4 hour one, it was the perfect length for us.&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandglacierall.jpg&quot; alt=&quot;The team!&quot;&gt;&lt;p class=&quot;caption&quot;&gt;The team!&lt;/p&gt;&lt;/div&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandglacieralex.jpg&quot; alt=&quot;Alex volunteers to go through an ice tunnel first&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Alex volunteers to go through an ice tunnel first&lt;/p&gt;&lt;/div&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandglacierashy.jpg&quot; alt=&quot;The foot of the glacier&quot;&gt;&lt;p class=&quot;caption&quot;&gt;The foot of the glacier&lt;/p&gt;&lt;/div&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandglacierdown.jpg&quot; alt=&quot;Looking back down - the ice is always moving&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Looking back down - the ice is always moving&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;We set course for &lt;a href=&quot;http://en.wikipedia.org/wiki/Vik,_Iceland&quot;&gt;Vík&lt;/a&gt; after getting back from the glacier. Its a fascinating place - it lies beneath a glacier which covers Katla, the volcano our plane was named after. An eruption would melt the ice causing a flood that could destroy the town - a type of &lt;a href=&quot;http://en.wikipedia.org/wiki/Lahar&quot;&gt;lahar&lt;/a&gt;, and potentially fatal. We set up our tent at the busy campground, then again found ourselves picking between a hamburger diner (Iceland seems to quite like hamburgers!) or a pricey restaurant. We almost went with the diner until I noticed the restaurant had whale - which we had to try. For an entree I had shark, dried fish, and a shot of Brennivin. The whale was seemingly cooked rare, and was pretty tasty. It was hard to describe in terms of other flavors - steak-like in its consistency, but salty in a way steak would never be. I have no idea what the whale was, or even if it was whale , but it was most likely &lt;a href=&quot;http://en.wikipedia.org/wiki/Minke_Whale#Population_and_conservation_status&quot;&gt;minke whale&lt;/a&gt;, which is not endangered. We walked along the blank sand beaches after dinner in search of puffins, but it was too dark to see anything. We did see some impressive rock formations out in the water and could see many birds flying around hunting bugs and fish. We headed back to camp to rest for our final day (and to drink a beer or 3).&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandouttosea.jpg&quot; alt=&quot;A man-made road of boulders stretches into the sea at Vik&quot;&gt;&lt;p class=&quot;caption&quot;&gt;A man-made road of boulders stretches into the sea at Vik&lt;/p&gt;&lt;/div&gt;

&lt;h2&gt;Friday (South to South West)&lt;/h2&gt;

&lt;p&gt;Our puffin failure in the north-east did not deter us from the puffin hunt, and one of tourist maps suggested that a coastal area just along the coast from Vik had some sort of puffin nesting site. It certainly did - lots of puffins, everywhere! The rock formations in the area were also very impressive, and we walked out on a large spit of rock that had massive holes eroded into it.&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandspit.jpg&quot; alt=&quot;Alex and I are the two dots at the end&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Alex and I are the two dots at the end&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;The views on the southern coast were great, with black beaches that extended far out of sight. There was another waterfall on the road to Reykjavík, &lt;a href=&quot;http://en.wikipedia.org/wiki/Sk%C3%B3gafoss&quot;&gt;Skógafoss&lt;/a&gt;, which was pretty and large. I think I was almost natural-beauty-overloaded at that point though because I remember not feeling as excited about it. The number of tourists rose dramatically on the southern coast, which gave it a different feel too.&lt;/p&gt;

&lt;p&gt;We eventually made it to Reykjavík in the early afternoon, and headed to the accommodation we had booked before leaving  Höfn. It was an AirBnb-type setup where rooms in the bottom floor of house in an inner suburb were being rented out to travelers. The room was fantastic, beautifully decorated with a great natural hot water shower that smelled a bit of sulfur. The only downside - the homeowner was a crazy conspiracy theorist who cornered us at one point and lectured us about numerology, who shot JFK, and the imprisonment of Bobby Fisher. We were somewhat exhausted by this point, and it was hard to get motivated to see a city after the amazing natural things we had seen. Having said that, we did check out an &lt;a href=&quot;http://en.wikipedia.org/wiki/B%C3%A6jarins_Beztu_Pylsur&quot;&gt;Icelandic hotdog chain&lt;/a&gt; that made some pretty fantastic hotdogs. The woman making hotdogs did so with such amazing precision and speed that when John and I went back for seconds, I think it was partly just to see the process again. We had a quick look at &lt;a href=&quot;http://en.wikipedia.org/wiki/Perlan&quot;&gt;The Pearl&lt;/a&gt;, a very fancy hot water storage tank, and the only thing in Reykjavík that I had to see: the &lt;a href=&quot;http://en.wikipedia.org/wiki/Hallgr%C3%ADmskirkja&quot;&gt;Hallgrímskirkja&lt;/a&gt; church. The exterior was as impressive as I thought it would be, but the interior was a real surprise. It is very simple and austere, apart from small notes of detail and color: the organ, a small number of stained glass windows, and a couple of sculptures.&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandchurch.jpg&quot; alt=&quot;Inspired architecture&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Inspired architecture&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;We returned back to our accommodation for some rest before dinner. After considering the various options, we decided to go with the charmingly-named Cafe Loki, which serves sampling plates of traditional Icelandic fare as well as interesting teas, including one that had moss and birch in it! After dinner we headed to a Beatles-themed bar we had spotted earlier called &lt;a href=&quot;https://www.facebook.com/pages/Obladi-Oblada/139540706057159&quot;&gt;Ob-La-Di Ob-La-Da&lt;/a&gt; that was full of... eccentric older gentleman. We fled after one drink to a &lt;a href=&quot;http://en.wikipedia.org/wiki/The_Big_Lebowski&quot;&gt;The Big Lebowski&lt;/a&gt; themed bar called, simply, &lt;a href=&quot;https://www.facebook.com/pages/Lebowskibar/156528837802169&quot;&gt;Lebowskibar&lt;/a&gt;. They served (pricey) Lebowski-themed cocktails, had dance-able music playing, bowling memorabilia everywhere, and featured some couchsurfing-friendly locals that we chatted to for the night. It was a pretty successful end to our trip. The next day we left for the airport early in the morning, and returned to Boston later on the Saturday.&lt;/p&gt;

&lt;p&gt;The end!&lt;/p&gt;

&lt;h2&gt;The Map&lt;/h2&gt;

&lt;p&gt;There were many maps we used during the trip, including the sometimes-very-wrong GPS device in the car. However one map in particular was valuable throughout, and I&amp;#39;ve still got it:&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandsmallmap.jpg&quot; alt=&quot;Old faithful&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Old faithful&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;A map that might be more useful to you if you want to explore the path we took is the following map that I made with &lt;a href=&quot;http://goo.gl/maps/d5TV5&quot;&gt;Google Maps&lt;/a&gt;. Each day is its own color, and I&amp;#39;ve labelled a majority of landmarks mentioned in the text. I think this really shows the pace you need to sustain to make it around in 6 full days - something that is hard to estimate &lt;em&gt;a priori&lt;/em&gt;.&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/icelandmap.jpg&quot; alt=&quot;Our route - one color per day&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Our route - one color per day&lt;/p&gt;&lt;/div&gt;

&lt;h2&gt;What I spent&lt;/h2&gt;

&lt;p&gt;Iceland is definitely not the cheapest place to visit, although getting a good price for your flights helps. The approximate breakdown of my expenses was as follows (all USD). I would know more precisely but I paid for some things in cash, and sometimes one of us would get the gas and the other person would get dinner, and so on.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;$600 for the flights (booked early, great price)&lt;/li&gt;
&lt;li&gt;~$300 for gas (we split the total gas bill between us, this was my share)&lt;/li&gt;
&lt;li&gt;~$80 for accommodation&lt;/li&gt;
&lt;li&gt;$250-300 for food&lt;/li&gt;
&lt;li&gt;$130 for activities (Blue Lagoon + glacier)&lt;/li&gt;
&lt;li&gt;~$350-400 for car rental (my third of the bill, we got a good deal with this too)&lt;/li&gt;
&lt;li&gt;My total spend: $1803.49&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;You probably could not cut down on the biggest components of the cost without doing a very different trip. Some people seem to just visit the lower area - e.g. Reykjavik, to Geyser, to Skogafoss, to Jokulsarlon, and back. There quite a few buses on the roads in the south, but I&amp;#39;m not sure if you can hop-on hop-off with them. Hitchhiking not recommended - we saw a few people trying it and it didn&amp;#39;t seem to be going great. We couldn&amp;#39;t even fit them in usually because it was hardly ever one person and we had all our gear too. You could cut down on your food budget by stocking up in Reykjavik and doing cooking on a burner, or just avoiding restaurants entirely.&lt;/p&gt;
</description>
				<pubDate>Wed, 05 Jun 2013 03:08:52 -0400</pubDate>
				<link>http://iaindunning.com/2013/an-icelandic-adventure.html</link>
				<guid isPermaLink="true">http://iaindunning.com/2013/an-icelandic-adventure.html</guid>
			</item>
		
			<item>
				<title>Simulation Study of a Laundry Room</title>
				<description>&lt;p&gt;For my first two years at MIT I lived in graduate housing (&lt;a href=&quot;http://s-p.mit.edu/&quot;&gt;Sidney-Pacific&lt;/a&gt;, to be exact). Its a big building: about 700 graduate students, one of, if not the, biggest graduate &amp;quot;dorm&amp;quot; in North America. What I&amp;#39;m going to discuss today is pretty mundane, but maybe of interest to some: the laundry room! Assuming nothing is broken, there are are 24 washing machines (washers) and 24 dryers. The length of a cycle on the washers is 30 minutes, and the length of a cycle is at least 1 hour on the dryers, although you can pay for longer cycles if you want.&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/laundryroom.jpg&quot; alt=&quot;Screenshot from web-based laundry room monitor showing the layout&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Screenshot from web-based laundry room monitor showing the layout&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;Here is the primary observation: if it takes 30 minutes for a washing cycle, and an hour for a drying cycle, how is it that there isn&amp;#39;t a big problem? Obviously something is going on here to make it all work. What I wanted to do is experiment with &lt;a href=&quot;http://julialang.org/&quot;&gt;Julia&lt;/a&gt; to see what parameters would make the laundry room &amp;quot;work&amp;quot;, and not have a lot of unhappy people with wet clothing!&lt;/p&gt;

&lt;p&gt;First of all, lets characterize how people show up to the laundry. I&amp;#39;m going to assume initially that everyone uses only one washer, and that they arrive according to a &lt;a href=&quot;http://en.wikipedia.org/wiki/Poisson_process&quot;&gt;Poisson process&lt;/a&gt;. The first assumption will be relaxed later, so lets look at the second assumption. Its probably not &lt;em&gt;too&lt;/em&gt; bad on a busy Saturday/Sunday morning, so we&amp;#39;ll say thats the time of week we are looking at - if the laundry is quiet, it isn&amp;#39;t a problem anyway. We must also acknowledge the implied assumption that the number of machines in use doesn&amp;#39;t affect the arrival rate - this could be a big deal, although you could sort of get around it if this is the steady state rate after an adjustment for that.&lt;/p&gt;

&lt;p&gt;Lets assume at &amp;quot;steady state&amp;quot; that 75% of the washers are in use on average (18 machines). If people are arriving at a rate of λ (lambda) per hour, and the service time is 0.5 hours (30 minutes), we will have steady state when the rate of people finishing equals the rate of people arriving. That is, λ = n/0.5. So to get an average of 18 machines in use, we should assume 36 people are arriving per hour. From my own observations, and given that less than 24 machines are often working, one person every 2 minutes at peak time seems OK. If we assume that people move their washing instantly into a dryer, again only using one of each,  λ = n/1.5, so we&amp;#39;d only need ~15 people an hour for things to start backing up. The model we will experiment with is as follows:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Residents arrive at a rate of λ=36 per hour. If all the washers are in use, they will leave - no queueing. If there is a free machine, they will take it and start a 30 minute cycle on a single machine.&lt;/li&gt;
&lt;li&gt;At the end of the wash cycle, they will do one of two things:

&lt;ul&gt;
&lt;li&gt;With probability &lt;em&gt;p&lt;/em&gt; they will put their clothes in a dryer, if available, and set it for an hour cycle. If there is no free dryer they will wait for one.&lt;/li&gt;
&lt;li&gt;With probability &lt;em&gt;1-p&lt;/em&gt; they will take their clothes to their room and put them on a drying rack.&lt;/li&gt;
&lt;li&gt;The probabilities are independent of the number of dryers in use.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We will play with different values of p to investigate the affect on the time-averaged queue length of the dryers. The code to do this was written in &lt;a href=&quot;http://julialang.org/&quot;&gt;Julia&lt;/a&gt; using the &lt;a href=&quot;https://github.com/BenLauwens/SimJulia.jl&quot;&gt;SimJulia&lt;/a&gt; package, with inter-arrival times generated using &lt;a href=&quot;https://github.com/JuliaStats/Distributions.jl&quot;&gt;Distributions.jl&lt;/a&gt;. We ignore the start-up effects for simplicity reasons by running the simulation for 1000 hours (only a takes a second to simulate it though). The code will be at the bottom of this post. The plotting was done with gnuplot, although Julia does have some good plotting functionality.&lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/laundryroomdry.png&quot; alt=&quot;Queue length versus probability of drying in room&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Queue length versus probability of drying in room&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;As you can see, as the probability goes to zero the queue length starts to grow exponentially, as you&amp;#39;d expect from queuing theory/back of the envelope calculations. Increasing probability now, by the time we reach &lt;em&gt;p=0.4&lt;/em&gt;, the average queue length is down to 1 - this is probably &amp;quot;good enough&amp;quot;. So, under these assumptions, roughly half the people would need to be taking their laundry to their room. This seems unlikely to me, so lets revisit our model and change some things around.&lt;/p&gt;

&lt;h2&gt;A more complex arrival process&lt;/h2&gt;

&lt;p&gt;One assumption we made above was that each person only uses one machine. This is definitely not true - you&amp;#39;ll see people use two quite a bit. We will add a new parameter q - the probability someone uses two washing machines. I&amp;#39;ll also make the assumption that even if someone uses two washing machines, they only use one dryer (or don&amp;#39;t use a dryer at all). To maintain our 75% average usage of the washing machines, we need to calculate λ as a function of q. If we want 18 machines in use on average at steady state, we need λ to satisfy the formula ((1-q) + 2q)λ = (1 + q)λ = 18/0.5. We can check this is right: if q=0, we obtain λ=36 as before, and q=1 we obtain λ=18 - as you&amp;#39;d expect. Another intuition check: if every person uses two washing machines, and the steady state is less than capacity, then you&amp;#39;d expect the steady state usage of dryers to be equal to the steady state usage of washing machines. &lt;/p&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/laundrytwowash.png&quot; alt=&quot;Queue length versus probability of drying in room and probability of using two washing machines&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Queue length versus probability of drying in room and probability of using two washing machines&lt;/p&gt;&lt;/div&gt;

&lt;p&gt;The plot suggests we can get a similar queue length to &lt;em&gt;p=0.4, q=0.0&lt;/em&gt; with &lt;em&gt;p=0.2, q=0.3&lt;/em&gt;, which seems more realistic.&lt;/p&gt;

&lt;h2&gt;Conclusions and Future Work&lt;/h2&gt;

&lt;p&gt;In general this full model seems to suggest that the laundry room is barely stable at its busiest point, and that there are probably times during peak usage where someone might need to wait for a dryer (or give up and dry it in their room). Fortunately it seems that the laundry room rarely reaches that level of usage so its not a big deal. There are some factors that could make the situation &amp;#39;worse&amp;#39;: people running longer cycles, using two dryers if they use two washers, the delays between washer and dryer and with people taking dried clothing out of the dryer. Factors making it &amp;#39;better&amp;#39; are that people might check the number of machines in use before coming down, thus the arrival rate slows as the number of machines in use grows. Because I used a simulator instead of doing it analytically, it would be easy to extend this code to include these effects. However, estimating parameters for these would require some data collection/surveying - probably not worth it!&lt;/p&gt;

&lt;p&gt;Another thing that would be easy to change but hard to calibrate would be to model people queued for the dryers as leaving their washing in the washing machine(s). This would actually be a very easy change to the code, and would make the problem a lot more painful to analyze analytically - especially if you threw in a random time delay after the wash cycle. That is the beauty of simulation, but I&amp;#39;d spend so much time tinkering with parameters it didn&amp;#39;t seem worth it. All in all, this was a good distraction from &amp;quot;real&amp;quot; work and shows the versatility of Julia.&lt;/p&gt;

&lt;h2&gt;Appendix: the code&lt;/h2&gt;

&lt;p&gt;Here is the code for the one-person-one-washer version.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;julia&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Laundry Simulator&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Iain Dunning, 2013&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Distributions&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SimJulia&lt;/span&gt;
    
&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MAX_WASHER&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MAX_DRYER&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STEADY_STATE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;18&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WASHER_SERVICE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DRYER_SERVICE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;
    
&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt; useWash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;washers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Resource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dryers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Resource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dryRoomChance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Float64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# Arrive at laundry&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;arrivalTime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# Check if enough washing machines&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;numWashInUse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;washers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;active_set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;numWashToUse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;numWashInUse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MAX_WASHER&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# Insufficient washing machines&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# Using washing machines&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;washers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;hold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WASHER_SERVICE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;release&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;washers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
  &lt;span class=&quot;c&quot;&gt;# Decide whether we will dry in room, or dry in dryer&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dryRoomChance&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# Try to use dryer&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dryers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;hold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DRYER_SERVICE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;release&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dryers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt; genPerson&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;washers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Resource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dryers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Resource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dryRoomChance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Float64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;arrivalRate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STEADY_STATE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WASHER_SERVICE&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;exp_dist&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Exponential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arrivalRate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;person&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;simulation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sprintf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Person%d&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;activate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;useWash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;washers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dryers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dryRoomChance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;interArrival&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp_dist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;hold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;interArrival&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt; runSim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dryRoomChance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Float64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;srand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;sim&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Simulation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;washers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Resource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Washers&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MAX_WASHER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;dryers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Resource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Dryers&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MAX_DRYER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Source&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;activate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;genPerson&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;washers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dryers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dryRoomChance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1000.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;TimeAverage washers in use: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;(time_average(activity_monitor(washers)))&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;TimeAverage dryers in use: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;(time_average(activity_monitor(dryers)))&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;TimeAverage dryer queue length: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;(time_average(wait_monitor(dryers)))&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time_average&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wait_monitor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dryers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
				<pubDate>Thu, 16 May 2013 17:12:36 -0400</pubDate>
				<link>http://iaindunning.com/2013/simulation-study-of-a-laundry-room.html</link>
				<guid isPermaLink="true">http://iaindunning.com/2013/simulation-study-of-a-laundry-room.html</guid>
			</item>
		
			<item>
				<title>Experiences with Setting Up Xmonad on Ubuntu 12</title>
				<description>&lt;p&gt;After being impressed with a friends &lt;a href=&quot;http://xmonad.org/&quot;&gt;Xmonad&lt;/a&gt; setup, I decided to give it a go for myself. &lt;a href=&quot;http://xmonad.org/&quot;&gt;Xmonad&lt;/a&gt;, in short, is a &lt;a href=&quot;http://en.wikipedia.org/wiki/Window_manager&quot;&gt;window manager&lt;/a&gt; that automatically tiles and aligns all your windows - the idea being that you shouldn&amp;#39;t mess around with these things manually yourself, because you usually want your windows to fill up the screen anyway. Before switching to Ubuntu+XMonad I primarily used Windows 7. I used the Windows-Left and Windows-Right key combinations to align two windows side-by-side all the time, so this appealed to me. I had also been meaning to use Linux on a more full-time basis, as I previously only used it when needed, usually as a virtual machine guest. This summer I will be using it a lot more so I figured why not fully embrace it. So here is my journey to going from a fresh Ubuntu install to using Xmonad as my window manager, written mostly in real-time as I did it. Hopefully it may help someone get started - there are many posts about this sort of thing on the internet, but maybe this simpler step-by-step guide will be easier to understand than downloading a configuration file.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Update&lt;/em&gt;: After writing this post and its updates, I posted my configuration files on Github: &lt;a href=&quot;https://github.com/IainNZ/dotfiles&quot;&gt;https://github.com/IainNZ/dotfiles&lt;/a&gt;. You might find it handy to refer to them as the &amp;quot;finished product&amp;quot;.&lt;/p&gt;

&lt;h2&gt;Initial Setup: Install Ubuntu, xmonad, Xmobar, simple configs&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;I started up a terminal (in case you were initially confused by the Unity interface, like me, you click the icon in the top left and type in what you want, in this case &lt;em&gt;terminal&lt;/em&gt;) and installed xmonad through the package manager: &lt;em&gt;sudo apt-get install xmonad&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;I then logged out. Now, to log-in with xmonad as my window manager, I click the little Ubuntu icon next to my name and selected &amp;quot;XMonad&amp;quot; (not &amp;quot;GNOME with Xmonad&amp;quot; - the subtleties escape me at the moment...). After typing in my password and hitting enter, nothing seem to happen except the log-in screen goes away.&lt;/li&gt;
&lt;li&gt;Its not broken - there is just nothing open. Hitting &lt;em&gt;alt-shift-enter&lt;/em&gt; opens a terminal, and hitting it again opens another, putting them side-by-side. You can move the mouse to shift focus, or press &lt;em&gt;alt-j&lt;/em&gt; and &lt;em&gt;alt-k&lt;/em&gt; to cycle between windows. For more shortcuts, I found &lt;a href=&quot;http://xmonad.org/tour.html&quot;&gt;this tour&lt;/a&gt; really helpful. Helpful tip, if you need to bail out of XMonad before going on: to log out, &lt;em&gt;alt-shift-q&lt;/em&gt; will work.&lt;/li&gt;
&lt;li&gt;If you are anything like me, you&amp;#39;ll find the idea of using alt for managing windows like this a bit unnatural. Given that the Windows key is on my keyboard, makes sense to me to use that instead. Fortunately this is pretty easy to do and is my first customization of xmonad. Apparently customization is another of the virtues of Xmonad, and you actually write the configuration file as a &lt;a href=&quot;http://en.wikipedia.org/wiki/Haskell_(programming_language&quot;&gt;Haskell&lt;/a&gt;) script!

&lt;ul&gt;
&lt;li&gt;First we need a directory to store our configuration (&lt;code&gt;mkdir ~/.xmonad&lt;/code&gt;), and to create and edit the config file itself (e.g. &lt;code&gt;nano ~/.xmonad/xmonad.hs&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;The code we&amp;#39;ll use is as follows (from &lt;a href=&quot;http://www.haskell.org/haskellwiki/xmonad/Frequently_asked_questions#Rebinding_the_mod_key_.28Alt_conflicts_with_other_apps.3B_I_want_the_____key.21.29&quot;&gt;here&lt;/a&gt;):&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;&lt;span class=&quot;kr&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;XMonad&lt;/span&gt;

&lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xmonad&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;defaultConfig&lt;/span&gt;
         &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;modMask&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mod4Mask&lt;/span&gt;
         &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;The above code says to run xmonad according to the default values except for the modifications listed in this key-value structure. &lt;em&gt;mod4Mask&lt;/em&gt; indicates the Windows key for most keyboards. To use the new settings, press &lt;em&gt;alt-q&lt;/em&gt; to reload xmonad.hs. Test it out by creating a new terminal with &lt;em&gt;win-shift-enter&lt;/em&gt;, and close it with &lt;em&gt;win-shift-c&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;This is all rather barebones, although I kind of like how clean it is. I installed two packages that seem to come fairly highly recommended: &lt;a href=&quot;http://tools.suckless.org/dmenu/&quot;&gt;dmenu&lt;/a&gt;, a progam launcher, and &lt;a href=&quot;http://projects.haskell.org/xmobar/&quot;&gt;xmobar&lt;/a&gt;, a status bar progam.

&lt;ul&gt;
&lt;li&gt;First up, dmenu: &lt;code&gt;sudo apt-get install suckless-tools&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Press &lt;em&gt;win-p&lt;/em&gt; to bring it up. We&amp;#39;re presented with a list of program names. Start typing a name, e.g. firefox, to get auto-suggestions. Easy!&lt;/li&gt;
&lt;li&gt;Next, xmobar: &lt;code&gt;sudo apt-get install xmobar&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;We need to create a configuration file, much like we did for xmonad itself. There is an example file &lt;a href=&quot;http://www.haskell.org/haskellwiki/Xmonad/Config_archive/John_Goerzen%27s_Configuration#Configuring_xmobar&quot;&gt;here&lt;/a&gt;, which is pretty intense at first but you can break it down. Create the file with, e.g. &lt;code&gt;nano ~/.xmobarrc&lt;/code&gt; and copy-paste the default config from above. For now, I just changed the weather station from EGPF to KBOS (for Boston Logan International Airport).&lt;/li&gt;
&lt;li&gt;Finally we extend our xmonad.hs to connect it to xmobar. I used the relevant sections from &lt;a href=&quot;http://www.haskell.org/haskellwiki/xmonad/Config_archive/John_Goerzen%27s_Configuration#Configuring_xmonad_to_use_xmobar&quot;&gt;here&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;photo&quot;&gt;&lt;img src=&quot;/images/xmonadsshot.png&quot; alt=&quot;Screenshot showing a typical Xmonad layout with Xmobar&quot;&gt;&lt;p class=&quot;caption&quot;&gt;Screenshot showing a typical Xmonad layout with Xmobar&lt;/p&gt;&lt;/div&gt;

&lt;h2&gt;Adventures with Multiple Monitors&lt;/h2&gt;

&lt;p&gt;At my office I use a dual monitor setup. Unfortunately it was not a matter of plug-and-play, but it wasn&amp;#39;t too hard to get it working:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;I logged into Unity, and setup my screens so they weren&amp;#39;t cloned. Not sure if this was necessary/helped&lt;/li&gt;
&lt;li&gt;I logged into xmonad, and the screens were cloned - not good!&lt;/li&gt;
&lt;li&gt;Running the xrandr command listed my screens - now I know what they are called, I can change them!&lt;/li&gt;
&lt;li&gt;The following command solved my issues: &lt;code&gt;xrandr --output HDMI-1 --auto --left-of LVDS-1&lt;/code&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;--output&lt;/code&gt; is the screen we want to deal with (in this case, I&amp;#39;m connected via HDMI)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--auto&lt;/code&gt; means to use the default resolution for that monitor&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--left-of LVDS-1&lt;/code&gt; means that the screen is physically to the left of my laptop&amp;#39;s screen&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Now, unfortunately, xmobar only shows up on my laptop screen. I haven&amp;#39;t quite figured out how to make it appear on both, but you can make it appear on the main screen using &lt;code&gt;xrandr --output HDMI-1 --primary&lt;/code&gt; (via &lt;a href=&quot;http://blog.ezyang.com/2011/06/multi-monitor-xmobar-placement-on-nome/&quot;&gt;this post&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;Volume Control in Xmonad/Xmobar&lt;/h2&gt;

&lt;p&gt;So after getting set up and using the system a bit, I realized I had no idea a) how to see what the volume is, and b) how to change it. I&amp;#39;m going to deal with (b) first, using the info &lt;a href=&quot;http://superuser.com/questions/389737/how-do-you-make-volume-keys-and-mute-key-work-in-xmonad&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;First we need to add a new import to allow us to configure some new key combinations at the top of xmonad.hs, that is very common in a lot of configs: &lt;code&gt;import XMonad.Util.EZConfig(additionalKeys)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Next we import some user-friendly names for the &amp;quot;special&amp;quot; keys on our keyboard: &lt;code&gt;import Graphics.X11.ExtraTypes.XF86&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;The &lt;code&gt;additionalKeys&lt;/code&gt; is going to go after our &lt;code&gt;defaultConfig&lt;/code&gt; section, and will look like this:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;&lt;span class=&quot;p&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;additionalKeys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;`&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xF86XK_AudioLowerVolume&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spawn&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;amixer set Master on &amp;amp;&amp;amp; amixer set Headphone on &amp;amp;&amp;amp; amixer set Master 2-&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
      &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xF86XK_AudioRaiseVolume&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spawn&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;amixer set Master on &amp;amp;&amp;amp; amixer set Headphone on &amp;amp;&amp;amp; amixer set Master 2+&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xF86XK_AudioMute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spawn&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;amixer set Master toggle &amp;amp;&amp;amp; amixer set Headphone toggle&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;The above is pretty complicated, but there is a reason: the problem seems to be that toggling the Master volume control turns Headphone off, but toggling it again does not turn it on, see &lt;a href=&quot;http://ubuntuforums.org/showthread.php?t=1796713&quot;&gt;here&lt;/a&gt; or &lt;a href=&quot;http://askubuntu.com/questions/65764/how-do-i-toggle-sound-with-amixer&quot;&gt;here&lt;/a&gt;. Something is still not totally right with the unmute button, it seems to work after after a random time, but pressing a volume key to unmute works fine.&lt;/li&gt;
&lt;li&gt;Now we want to display the volume in Xmobar. It seems the best way is to have a little script that takes the output of amixer and parses the volume from it.  Lets break it down:

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;amixer get master&lt;/code&gt; spits out the volume info, including a volume percentage.&lt;/li&gt;
&lt;li&gt;We pipe that into &lt;code&gt;awk&lt;/code&gt;, this (crazy/awesome) command line text processing tool&lt;/li&gt;
&lt;li&gt;We are going to pass the command &lt;code&gt;-F&amp;#39;[\[\]]&amp;#39;&lt;/code&gt; to &lt;code&gt;awk&lt;/code&gt; first. &lt;code&gt;-F&lt;/code&gt; is the field seperator argument - this is what we are going to &amp;quot;split&amp;quot; on (the square brackets)&lt;/li&gt;
&lt;li&gt;Next we want to get out the percentage - the second field: &lt;code&gt;&amp;#39;{print $2}&amp;#39;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;If you run what we have so far, you notice we get a lot of blank lines - this is from the lines that didn&amp;#39;t match our pattern (I think). We pipe the output into &lt;code&gt;tail -n 1&lt;/code&gt; to just get the last line&lt;/li&gt;
&lt;li&gt;What happens if we mute it? It still shows the volume... But, &lt;code&gt;$6&lt;/code&gt; (the sixth field) has the on/off info we need. So lets modify our print statement to &lt;code&gt;&amp;#39;{if ($6 == &amp;quot;off&amp;quot;) { print &amp;quot;MUT&amp;quot;; } else { print $2; }}&amp;#39;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Putting it all together: &lt;code&gt;amixer get Master | awk -F&amp;#39;[\[\]]&amp;#39; &amp;#39;{if ($6 == &amp;quot;off&amp;quot;) {print &amp;quot;MUT&amp;quot;; } else { print $2; }}&amp;#39; | tail -n 1&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;I put this in a script &lt;code&gt;getvolume.sh&lt;/code&gt;, and modified my &lt;code&gt;.xmobarrc&lt;/code&gt; to have the following line which is pretty self explanatory (the 10 is the refresh rate):  &lt;code&gt;Run Com &amp;quot;/home/idunning/getvolume.sh&amp;quot; [] &amp;quot;vol&amp;quot; 10&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Finally put &lt;code&gt;%vol%&lt;/code&gt; in your formatting string and restart Xmonad/Xmobar with Win-q - looks good!&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;Adding a system tray&lt;/h2&gt;

&lt;p&gt;For several months I would log into Unity to set up new wireless networks. This is a bit of kludge though, so I decided to add a real system tray. This also means I can now see whether Dropbox is syncing! This section borrows heavily from &lt;a href=&quot;https://github.com/davidbrewer/xmonad-ubuntu-conf&quot;&gt;this configuration&lt;/a&gt;.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;First step is to install a tray application. There are many options but I went with &lt;a href=&quot;http://stalonetray.sourceforge.net/&quot;&gt;stalonetray&lt;/a&gt; which you can install with &lt;code&gt;sudo apt-get install stalonetray&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Now lets make some room for the tray. Go into xmobarrc and change &lt;code&gt;TopW L 100&lt;/code&gt; to &lt;code&gt;TopW L 95&lt;/code&gt; (95% width) - you can adjust this based on your screen size. It is also possible to specify the exact width in pixels.&lt;/li&gt;
&lt;li&gt;We need to tell Xmonad to ignore the tray, i.e. let it display on all workspaces, no border. Add the following code after the imports in xmonad.hs...&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;&lt;span class=&quot;nf&quot;&gt;myManagementHooks&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;ManageHook&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;myManagementHooks&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;resource&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=?&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;stalonetray&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doIgnore&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;... and add change the &lt;code&gt;manageHook&lt;/code&gt; line to &lt;code&gt;manageHook = manageDocks &amp;lt;+&amp;gt; manageHook defaultConfig &amp;lt;+&amp;gt; composeAll myManagementHooks&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;We need to configure stalonetray. It looks for ~/.stalonetrayrc, so lets create that file now:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Icons stick to right side of tray&lt;/span&gt;
icon_gravity E
&lt;span class=&quot;c&quot;&gt;# Five icons wide, one high, 0 pixels from right, 0 from top&lt;/span&gt;
geometry 5x1-0+0
max_geometry 5x1-0+0
&lt;span class=&quot;c&quot;&gt;# Black background&lt;/span&gt;
background &lt;span class=&quot;s2&quot;&gt;&amp;quot;#000000&amp;quot;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Doesn&amp;#39;t appear in a task bar (not a problem for us?)&lt;/span&gt;
skip_taskbar
&lt;span class=&quot;c&quot;&gt;# Icons are 12 pixels high&lt;/span&gt;
icon_size 12
kludges force_icons_size
&lt;span class=&quot;c&quot;&gt;# Tell xmonad &amp;quot;Stand back, I got this&amp;quot;&lt;/span&gt;
window_strut none
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;Now we have a tray program, we want it to run automatically after we log in along with Dropbox and nm-applet (the wireless management applet). The file &lt;code&gt;/usr/share/xsessions/xmonad.desktop&lt;/code&gt; is what determines what logging in with Xmonad selected actually does. The line &lt;code&gt;exec=xmonad&lt;/code&gt; currently launches xmonad directly. We will replace this a bash script that launches the programs we want first before launching xmonad. Create a new file, e.g. &lt;code&gt;startxmonad.sh&lt;/code&gt;:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;
stalonetray &amp;amp;
nm-applet &amp;amp;
dropbox start
&lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;xmonad
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;Make it executable with &lt;code&gt;chmod +x startxmonad.sh&lt;/code&gt;. Now we have this file, we can modify the .desktop file, e.g. &lt;code&gt;sudo /usr/share/xsessions/xmonad.desktop&lt;/code&gt; and change the &lt;code&gt;exec=xmonad&lt;/code&gt; line to, e.g. &lt;code&gt;exec=/home/idunning/.xmonad/startxmonad.sh&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Now logout and log back in - hopefully you&amp;#39;ll see Dropbox and nm-applet running in your tray!&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;Putting my dotfiles on Github&lt;/h2&gt;

&lt;p&gt;Many people on Github have &amp;quot;dotfiles&amp;quot; repositories - basically a repo for all the little configuration files that you see above, as well as others. This &lt;a href=&quot;http://blog.smalleycreative.com/tutorials/using-git-and-github-to-manage-your-dotfiles/&quot;&gt;post&lt;/a&gt; really says it all better than I can, but basically its a cool idea and not only provides a backup for your configs, it also makes your experience homogenous across computers. The second factor was actually what motivated me to finally do it, as I just started an internship at Google. My repository is at &lt;a href=&quot;https://github.com/IainNZ/dotfiles&quot;&gt;https://github.com/IainNZ/dotfiles&lt;/a&gt; - there is nothing in there that is too fancy, but it might make the above more understandable. The best thing about it is in installation script, which puts symlinks to the dotfiles rather than copying them - allowing easy updates with a simple &lt;code&gt;git pull&lt;/code&gt;.&lt;/p&gt;
</description>
				<pubDate>Mon, 13 May 2013 03:17:12 -0400</pubDate>
				<link>http://iaindunning.com/2013/experiences-with-xmonad-and-ubuntu-12.html</link>
				<guid isPermaLink="true">http://iaindunning.com/2013/experiences-with-xmonad-and-ubuntu-12.html</guid>
			</item>
		
	</channel>
</rss>
