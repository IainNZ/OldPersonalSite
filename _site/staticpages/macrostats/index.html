<p><a href="http://idunning.scripts.mit.edu/blog/wp-content/uploads/2012/08/macrostats.png"><img src="http://idunning.scripts.mit.edu/blog/wp-content/uploads/2012/08/macrostats.png" alt=""></a></p>

<p><a href="https://github.com/IainNZ/MacroStats/zipball/master">Download</a> MacroStats from GitHub (<a href="https://github.com/IainNZ/MacroStats">repository</a>)</p>

<p><strong>MacroStats</strong> is a collection of statistics-related functions for Excel&#39;s <a href="http://en.wikipedia.org/wiki/Visual_Basic_for_Applications">VBA macro language</a>. The library arose from some work I did on various projects at <a href="http://www.scarlatti.co.nz/">Scarlatti</a> in 2011, and I thought they might save someone from &quot;reinventing the wheel&quot; - possibly myself!</p>

<p>There aren&#39;t a huge number of functions, but I&#39;d really love feedback if you use it at all. It is licensed under the very permissive <a href="http://www.opensource.org/licenses/mit-license.php">MIT License</a>, which will let you use it safely in commercial projects.</p>

<h3>Features</h3>

<h4>Random Number Generators</h4>

<ul>
<li><p>RandomFromNormal (<em>mean</em>, <em>stddev)</em></p>

<ul>
<li>Uses <a href="http://en.wikipedia.org/wiki/Normal_distribution#Generating_values_from_normal_distribution">Box-Mueller</a> to generate a random number from a <a href="http://en.wikipedia.org/wiki/Normal_distribution">normal distribution</a>.</li>
</ul></li>
<li><p>FlipCoin (<em>prob</em>)</p>

<ul>
<li>Returns True with probability <em>prob</em>.</li>
</ul></li>
<li><p>SampleDiscreteCDF (<em>CDF()</em>)</p>

<ul>
<li>Generate a random integer from a <a href="http://en.wikipedia.org/wiki/Cumulative_distribution_function">cumulative distribution function</a>.</li>
</ul></li>
<li><p>SampleDiscreteCDFon2D (<em>CDF(), FirstIndex</em>)</p>

<ul>
<li>Generate a random integer from a cumulative distribution function.</li>
<li>Use this when you have a 2D array, where the CDF is in the 2nd dimension.</li>
</ul></li>
<li><p>SampleDiscreteCDFon3D (<em>CDF(), FirstIndex, SecondIndex</em>)</p>

<ul>
<li>Generate a random integer from a cumulative distribution function.</li>
<li>Use this when you have a 3D array, where the CDF is in the 3rd dimension.</li>
</ul></li>
</ul>

<p>As an example of how to use the SampleDiscreteFromCDF functions, consider the following code snippet:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">Dim myCDF(3 to 6) as Double
myCDF(3) = 0.1
myCDF(4) = 0.5
myCDF(5) = 0.9
myCDF(6) = 1.0
Debug.Print SampleDiscreteCDF(myCDF)
&#39; 10% chance of returning a 3, 40% chance of a 4, etc.
</code></pre></div>
<p>The 2D and 3D versions are useful when you have a matrix describing multiple CDFs. See the code for a detailed example on exactly how to use these.</p>

<h4>Distribution Fitting Functions</h4>

<ul>
<li><p>FitNormalDistributionToData</p>

<ul>
<li>Inputs: <em>data()</em></li>
<li>Outputs: <em>mean, stddev</em></li>
<li>Fits a <a href="http://en.wikipedia.org/wiki/Normal_distribution">normal distribution</a> to a data set provided by the user. Uses <a href="http://en.wikipedia.org/wiki/Normal_distribution#Estimation_of_parameters">Maximum Likelihood Estimation</a>.</li>
</ul></li>
<li><p>FitNormalDistributionToPercentiles</p>

<ul>
<li>Inputs: <em>X1, P1, X2, P2</em></li>
<li>Outputs: <em>mean, stddev</em></li>
<li>Fits a normal distribution to two percentiles. For example:

<ul>
<li>50th percentile is 60 =&gt; <em>X1 = 60, P1 = 0.5</em></li>
<li>84th percentile is 80 =&gt; <em>X2 = 80, P2 = 0.84</em></li>
<li>Therefore <em>mean = 60, stddev = 20</em></li>
</ul></li>
</ul></li>
<li><p>FitGammaDistributionToData</p>

<ul>
<li>Inputs: <em>data()</em></li>
<li>Outputs: <em>shapeP, scaleP</em></li>
<li>Fits a <a href="http://en.wikipedia.org/wiki/Gamma_distribution">gamma distribution</a> to a data set provided by the user. Uses <a href="http://en.wikipedia.org/wiki/Gamma_distribution#Maximum_likelihood_estimation">Maximum Likelihood Estimation with Newton-Rhapson</a>.</li>
</ul></li>
<li><p>FitGammaDistributionToPercentiles</p>

<ul>
<li>Inputs: <em>X1, P1, X2, P2</em></li>
<li>Outputs: <em>shapeP, scaleP</em>

<ul>
<li>50th percentile is 5000 =&gt; X1 = 5000, P1 = 0.5</li>
<li>84th percentile is 6500 &gt;= X2 = 6500, P2 = 0.84</li>
<li>Therefore <em>shapeP = 13.5, scaleP = 378.9</em></li>
</ul></li>
</ul></li>
</ul>
